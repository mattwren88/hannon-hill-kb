<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Query Tool Directives - Cascade CMS Knowledge Base</title>
  <meta name="description" content="Introduced in Cascade CMS 8.26, Query Directives are an alternative to the .execute() method on the Query API. They process results one asset at a time instead of loading">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <script>
  (function () {
    var pref = localStorage.getItem('theme-preference');
    var theme;
    if (pref === 'dark') { theme = 'dark'; }
    else if (pref === 'light') { theme = 'light'; }
    else { theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'; }
    document.documentElement.setAttribute('data-theme', theme);
  })();
  </script>
  <link rel="stylesheet" href="../../../../_assets/css/tokens.css">
  <link rel="stylesheet" href="../../../../_assets/css/reset.css">
  <link rel="stylesheet" href="../../../../_assets/css/layout.css">
  <link rel="stylesheet" href="../../../../_assets/css/typography.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/sidebar.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/toc.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/breadcrumb.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/code-block.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/callout.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/accordion.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/steps.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/tabs.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/table.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/search.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/theme-toggle.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/cards.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/footer.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/buttons.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/badges.css">
  <link rel="stylesheet" href="../../../../_assets/css/components/tooltip.css">
  <link rel="stylesheet" href="../../../../_assets/css/utilities.css">
  <link rel="stylesheet" href="../../../../_assets/css/print.css" media="print">
  <link rel="stylesheet" href="../../../../_assets/vendor/prism/prism-theme.css">
  <link rel="stylesheet" href="../../../../_assets/css/transitions.css">
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <header class="header" role="banner">
    <div class="header__left">
      <button class="header__menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
      <a href="../../.././" class="header__logo"><span style="color: var(--color-primary-vivid); font-weight: 700;">Cascade</span>&nbsp;CMS Docs</a>
    </div>
    <nav class="header__nav" aria-label="Top navigation">
      <a href="#" class="header__nav-link header__nav-link--active">Knowledge Base</a>
      <a href="#" class="header__nav-link">Release Notes</a>
      <a href="#" class="header__nav-link">Support</a>
    </nav>
    <div class="header__right">
      <button class="header__search-trigger" aria-label="Search documentation">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <span class="header__search-text">Search...</span>
        <kbd class="header__search-kbd">âŒ˜K</kbd>
      </button>
      <div class="theme-toggle">
        <button class="theme-toggle__button" aria-label="Toggle color theme" aria-expanded="false" aria-haspopup="true">
          <svg class="theme-toggle__icon theme-toggle__icon--light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
          <svg class="theme-toggle__icon theme-toggle__icon--dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
          <svg class="theme-toggle__icon theme-toggle__icon--system" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
        </button>
        <div class="theme-toggle__dropdown" role="menu" hidden>
          <button class="theme-toggle__option" role="menuitem" data-theme="light">Light</button>
          <button class="theme-toggle__option" role="menuitem" data-theme="dark">Dark</button>
          <button class="theme-toggle__option theme-toggle__option--active" role="menuitem" data-theme="system">System</button>
        </div>
      </div>
    </div>
  </header>

  <div class="sidebar-overlay"></div>
  <div class="docs-layout">
    <aside class="sidebar" aria-label="Documentation navigation">
      <nav class="sidebar__nav">
        <div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    _archive
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../_archive/" class="sidebar__link">_archive Overview</a></li>
<li><a href="../../../_archive/how-to-set-up-a-spectate-connector/" class="sidebar__link">Spectate Connector</a></li>
<li><a href="../../../_archive/how-to-set-up-a-twitter-connector/" class="sidebar__link">Twitter Connector</a></li>
<li><a href="../../../_archive/what-is-the-locator-tool/" class="sidebar__link">What is the Locator Tool?</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    _cascade
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../_cascade/" class="sidebar__link">_cascade Overview</a></li>
<li><a href="../../../_cascade/base-assets/faq-article/" class="sidebar__link">FAQ Article</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Cascade Administration
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../cascade-administration/" class="sidebar__link">Cascade Administration Overview</a></li>
<li><a href="../../../cascade-administration/permissions/access-rights/" class="sidebar__link">Access Rights</a></li>
<li><a href="../../../cascade-administration/connectors/digital-asset-management-dam/widen-collective-integration/" class="sidebar__link">Acquia DAM (Widen) Integration (Labs)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/windows-service/" class="sidebar__link">Add or remove the Windows service</a></li>
<li><a href="../../../cascade-administration/administration-menus/" class="sidebar__link">Administration Menus</a></li>
<li><a href="../../../cascade-administration/administration-tools/broadcast-messages/" class="sidebar__link">Announcements</a></li>
<li><a href="../../../cascade-administration/audits/" class="sidebar__link">Audits</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/cascade-8-upgrade-prep/" class="sidebar__link">Cascade CMS 8 Upgrade Prep Guide</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/configure-a-web-server-for-publishing/" class="sidebar__link">Configure a web server for publishing</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/logging-rotation-compression/" class="sidebar__link">Configuring Cascade CMS Log Rotation and Compression</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/java-configuration/" class="sidebar__link">Configuring Cascade CMS to point to a Java installation</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/email-proxy-support/" class="sidebar__link">Configuring outbound proxy support for system-generated emails</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/heap-dump-oom/" class="sidebar__link">Configuring the Heap Dump on Out of Memory option</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/database/db-backup/" class="sidebar__link">Creating a database backup</a></li>
<li><a href="../../../cascade-administration/database-tools/database-export/" class="sidebar__link">Database Export</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/database/db-size-manage/" class="sidebar__link">Database Size Management Tips</a></li>
<li><a href="../../../cascade-administration/connectors/web-governance/dubbot-integration/" class="sidebar__link">DubBot Integration</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/enabling-http-strict-transport-security-hsts/" class="sidebar__link">Enabling HTTP Strict Transport Security (HSTS)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/enabling-or-disabling-tls-versions/" class="sidebar__link">Enabling or Disabling TLS Versions</a></li>
<li><a href="../../../cascade-administration/external-link-checking/" class="sidebar__link">External Link Checking Preferences</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/firewall/" class="sidebar__link">Firewall Considerations</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/force-ssl-tls/" class="sidebar__link">Forcing connections to use SSL/TLS</a></li>
<li><a href="../../../cascade-administration/connectors/analytics/how-to-set-up-a-google-analytics-connector/" class="sidebar__link">Google Analytics Connector</a></li>
<li><a href="../../../cascade-administration/permissions/groups/" class="sidebar__link">Groups</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/macos/" class="sidebar__link">Installation/Upgrade (macOS)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/windows/" class="sidebar__link">Installation/Upgrade (Windows)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/linux/" class="sidebar__link">Installation/Upgrade (ZIP)</a></li>
<li><a href="../../../cascade-administration/authentication/ldap/index/" class="sidebar__link">LDAP/Active Directory Authentication</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/load-balancing/" class="sidebar__link">Load Balancing</a></li>
<li><a href="../../../cascade-administration/administration-tools/logging-configuration/" class="sidebar__link">Logging Configuration</a></li>
<li><a href="../../../cascade-administration/administration-tools/logs-and-system-information/" class="sidebar__link">Logs and System Information</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/migrate-server/" class="sidebar__link">Migrating Cascade CMS to a new server</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/migration-tool/" class="sidebar__link">Migration Tool</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/modify-ports/" class="sidebar__link">Modifying Application Ports</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/modify-db/" class="sidebar__link">Modifying the Database Configuration</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/modify-heap-size/" class="sidebar__link">Modifying the Heap Size</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/modify-thread-stack/" class="sidebar__link">Modifying the Thread Stack Size</a></li>
<li><a href="../../../cascade-administration/connectors/web-governance/monsido-integration/" class="sidebar__link">Monsido Integration</a></li>
<li><a href="../../../cascade-administration/database-tools/optimize-database/" class="sidebar__link">Optimize Database</a></li>
<li><a href="../../../cascade-administration/database-tools/path-repair-tool/" class="sidebar__link">Path Repair Tool</a></li>
<li><a href="../../../cascade-administration/database-tools/recycle-bin-checker/" class="sidebar__link">Recycle Bin Checker</a></li>
<li><a href="../../../cascade-administration/permissions/role-abilities-in-cascade/" class="sidebar__link">Role Abilities</a></li>
<li><a href="../../../cascade-administration/permissions/roles/" class="sidebar__link">Roles</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/running-cascade-cms-as-a-linux-service/" class="sidebar__link">Running Cascade CMS as a Linux service</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/securing-session-cookies/" class="sidebar__link">Securing session cookies</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/test-server/" class="sidebar__link">Setting up a test environment</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/database/mysql/" class="sidebar__link">Setting up the database (MySQL)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/database/oracle/" class="sidebar__link">Setting up the database (Oracle)</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/database/sqlserver/" class="sidebar__link">Setting up the database (SQL Server)</a></li>
<li><a href="../../../cascade-administration/sites/site-import-and-export/" class="sidebar__link">Site Import and Export</a></li>
<li><a href="../../../cascade-administration/connectors/web-governance/siteimprove-integration/" class="sidebar__link">Siteimprove Integration</a></li>
<li><a href="../../../cascade-administration/snippets/" class="sidebar__link">Snippets</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/ssl-tls-configuration/" class="sidebar__link">SSL/TLS Configuration</a></li>
<li><a href="../../../cascade-administration/system-dictionary/" class="sidebar__link">System Dictionary</a></li>
<li><a href="../../../cascade-administration/system-preferences/" class="sidebar__link">System Preferences</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/update-license/" class="sidebar__link">Updating the license key</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/upgrade-tomcat/" class="sidebar__link">Upgrading Tomcat independently of Cascade CMS</a></li>
<li><a href="../../../cascade-administration/permissions/users/" class="sidebar__link">Users</a></li>
<li><a href="../../../cascade-administration/installation-and-upgrades/system-configuration/apache-2.4-proxy/" class="sidebar__link">Using Apache 2.4 to proxy Cascade CMS</a></li>
<li><a href="../../../cascade-administration/connectors/digital-asset-management-dam/webdam-integration/" class="sidebar__link">Webdam by Bynder Integration (Labs)</a></li>
<li><a href="../../../cascade-administration/connectors/content-export/how-to-set-up-a-wordpress-connector/" class="sidebar__link">WordPress Connector</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Cascade Basics
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../cascade-basics/" class="sidebar__link">Cascade Basics Overview</a></li>
<li><a href="../../../cascade-basics/asset-display-options/" class="sidebar__link">Asset Display Options</a></li>
<li><a href="../../../cascade-basics/comments/" class="sidebar__link">Comments and Mentions</a></li>
<li><a href="../../../cascade-basics/using-the-context-menu/" class="sidebar__link">Context Menu</a></li>
<li><a href="../../../cascade-basics/creating-content/" class="sidebar__link">Creating Content</a></li>
<li><a href="../../../cascade-basics/daily-content-report/" class="sidebar__link">Daily Content Report</a></li>
<li><a href="../../../cascade-basics/drafts-and-working-copies/" class="sidebar__link">Drafts and Working Copies</a></li>
<li><a href="../../../cascade-basics/search/full-search-and-replace/" class="sidebar__link">Full Search and Replace</a></li>
<li><a href="../../../cascade-basics/my-content/" class="sidebar__link">My Content</a></li>
<li><a href="../../../cascade-basics/the-dashboard/" class="sidebar__link">The Dashboard</a></li>
<li><a href="../../../cascade-basics/unpublishing-deleting-which-is-best/" class="sidebar__link">Unpublishing vs. Deleting Content - Which is best?</a></li>
<li><a href="../../../cascade-basics/account-settings/" class="sidebar__link">User Menu and Account Settings</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Content Authoring
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../content-authoring/" class="sidebar__link">Content Authoring Overview</a></li>
<li><a href="../../../content-authoring/ai-content-and-seo-suggestions/" class="sidebar__link">AI Content and SEO Suggestions</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/index/" class="sidebar__link">Asset Factory Plugins</a></li>
<li><a href="../../../content-authoring/asset-naming-rules/" class="sidebar__link">Asset Naming Rules</a></li>
<li><a href="../../../content-authoring/content-checks/" class="sidebar__link">Content Checks</a></li>
<li><a href="../../../content-authoring/content-tips/" class="sidebar__link">Content Tips</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/create-resized-images-plug-in/" class="sidebar__link">Create Resized Images Plug-in</a></li>
<li><a href="../../../content-authoring/advanced-code-editor/css-editor-snippets/" class="sidebar__link">CSS Editor Snippets</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/data-definition-field-to-system-name-plug-in/" class="sidebar__link">Data Definition Field(s) to System Name Plug-in</a></li>
<li><a href="../../../content-authoring/publishing/destinations/" class="sidebar__link">Destinations</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/display-to-system-name-plug-in/" class="sidebar__link">Display to System Name Plug-in</a></li>
<li><a href="../../../content-authoring/pages/editable-fields/" class="sidebar__link">Editable Fields</a></li>
<li><a href="../../../content-authoring/blocks/feed-blocks/" class="sidebar__link">Feed Blocks</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/file-limit-plug-in/" class="sidebar__link">File Limit Plug-in</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/friendly-page-name/" class="sidebar__link">Friendly Page Name Plug-in</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/image-resizer-plug-in/" class="sidebar__link">Image Resizer Plug-in</a></li>
<li><a href="../../../content-authoring/blocks/index-blocks/" class="sidebar__link">Index Blocks</a></li>
<li><a href="../../../content-authoring/accessibility/keyboard-shortcuts/" class="sidebar__link">Keyboard Shortcuts</a></li>
<li><a href="../../../content-authoring/linking/" class="sidebar__link">Linking</a></li>
<li><a href="../../../content-authoring/accessibility/page-accessibility-checker/" class="sidebar__link">Native On-Page Accessibility Checker</a></li>
<li><a href="../../../content-authoring/publishing/publish-sets/" class="sidebar__link">Publish Sets</a></li>
<li><a href="../../../content-authoring/publishing/publishing-related-content/" class="sidebar__link">Publishing Related Content</a></li>
<li><a href="../../../content-authoring/references/" class="sidebar__link">References</a></li>
<li><a href="../../../content-authoring/pages/rendering-metrics/" class="sidebar__link">Rendering Metrics</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/set-start-date-plug-in/" class="sidebar__link">Set Start Date Plug-in</a></li>
<li><a href="../../../content-authoring/pages/system-tags/" class="sidebar__link">System Tags</a></li>
<li><a href="../../../content-authoring/tags/" class="sidebar__link">Tags</a></li>
<li><a href="../../../content-authoring/blocks/text-blocks/" class="sidebar__link">Text Blocks</a></li>
<li><a href="../../../content-authoring/asset-factories/plugins/title-to-system-name-plug-in/" class="sidebar__link">Title to System Name Plug-in</a></li>
<li><a href="../../../content-authoring/publishing/transports/" class="sidebar__link">Transports</a></li>
<li><a href="../../../content-authoring/versions/" class="sidebar__link">Versions</a></li>
<li><a href="../../../content-authoring/wysiwyg-editor-configurations/upgrade-guide/" class="sidebar__link">WYSIWYG Editor Configuration Upgrade Guide</a></li>
<li><a href="../../../content-authoring/blocks/xhtml-blocks/" class="sidebar__link">XHTML/Data Definition Blocks</a></li>
<li><a href="../../../content-authoring/blocks/xml-blocks/" class="sidebar__link">XML Blocks</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Content Management
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../content-management/" class="sidebar__link">Content Management Overview</a></li>
<li><a href="../../../content-management/reports/active-users-report/" class="sidebar__link">Active Users Report</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/assign-step-if-user-trigger/" class="sidebar__link">Assign Step If User Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/assign-to-content-owner-of-asset-trigger/" class="sidebar__link">Assign To Content Owner of Asset Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/assign-to-group-owning-asset-trigger/" class="sidebar__link">Assign To Group Owning Asset Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/assign-to-specified-group-trigger/" class="sidebar__link">Assign to Specified Group Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/assign-to-workflow-owner-trigger/" class="sidebar__link">Assign To Workflow Owner Trigger</a></li>
<li><a href="../../../content-management/workflows/how-do-i-assign-a-workflow/" class="sidebar__link">Assigning Workflows</a></li>
<li><a href="../../../content-management/reports/background-tasks/" class="sidebar__link">Background Tasks</a></li>
<li><a href="../../../content-management/reports/broken-links-report/" class="sidebar__link">Broken Link Report</a></li>
<li><a href="../../../content-management/reports/content-inventory-report/" class="sidebar__link">Content Inventory Report</a></li>
<li><a href="../../../content-management/reports/content-ownership-report/" class="sidebar__link">Content Ownership Report</a></li>
<li><a href="../../../content-management/content-review/" class="sidebar__link">Content Review</a></li>
<li><a href="../../../content-management/reports/content-up-for-review-report/" class="sidebar__link">Content Reviews Report</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/copy-folder-trigger/" class="sidebar__link">Copy Folder Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/create-new-workflow-trigger/" class="sidebar__link">Create New Workflow Trigger</a></li>
<li><a href="../../../content-management/workflows/custom-workflow-emails/" class="sidebar__link">Custom Workflow Emails</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/delete-parent-folder-trigger/" class="sidebar__link">Delete Parent Folder Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/delete-trigger/" class="sidebar__link">Delete Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/email-trigger/" class="sidebar__link">Email Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/merge-trigger/" class="sidebar__link">Merge Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/preserve-current-user-trigger/" class="sidebar__link">Preserve Current User Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/publish-containing-publish-set-trigger/" class="sidebar__link">Publish Containing Publish Set Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/publish-parent-folder-trigger/" class="sidebar__link">Publish Parent Folder Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/publish-set-trigger/" class="sidebar__link">Publish Set Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/publish-trigger/" class="sidebar__link">Publish Trigger</a></li>
<li><a href="../../../content-management/workflows/receiving-workflow-notifications/" class="sidebar__link">Receiving Workflow Notifications</a></li>
<li><a href="../../../content-management/relationships/" class="sidebar__link">Relationships</a></li>
<li><a href="../../../content-management/reports/stale-content-report/" class="sidebar__link">Stale Content Report</a></li>
<li><a href="../../../content-management/tasks/" class="sidebar__link">Tasks</a></li>
<li><a href="../../../content-management/trash/" class="sidebar__link">Trash</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/unpublish-and-delete-trigger/" class="sidebar__link">Unpublish and Delete Trigger</a></li>
<li><a href="../../../content-management/reports/user-activity-report/" class="sidebar__link">User Activity Report</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/version-trigger/" class="sidebar__link">Version Trigger</a></li>
<li><a href="../../../content-management/workflows/workflow-triggers/index/" class="sidebar__link">Workflow Triggers</a></li>
<li><a href="../../../content-management/workflows/workflow-xml-schema-reference/" class="sidebar__link">Workflow XML Schema Reference</a></li>
<li><a href="../../../content-management/reports/workflows-report/" class="sidebar__link">Workflows Report</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Design In Cascade
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../design-in-cascade/" class="sidebar__link">Design In Cascade Overview</a></li>
<li><a href="../../../design-in-cascade/data-definitions/data-definition-xml-schema-reference/" class="sidebar__link">Data Definition XML Schema Reference</a></li>
<li><a href="../../../design-in-cascade/configurations/linking-to-specific-outputs/" class="sidebar__link">Linking to Specific Outputs</a></li>
<li><a href="../../../design-in-cascade/metadata-sets/metadata-fields-in-cascade/" class="sidebar__link">Metadata Fields in Cascade</a></li>
<li><a href="../../../design-in-cascade/data-definitions/shared-fields/" class="sidebar__link">Shared Fields</a></li>
<li><a href="../../../design-in-cascade/data-definitions/what-are-smart-fields/" class="sidebar__link">Smart Fields</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="true">
    Developing In Cascade
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages">
    <li><a href="../../" class="sidebar__link">Developing In Cascade Overview</a></li>
<li><a href="../velocity-best-practices/" class="sidebar__link">Best practices for performance</a></li>
<li><a href="../../code-sections/" class="sidebar__link">Code Sections</a></li>
<li><a href="../date-tool-essentials/" class="sidebar__link">Date Tool Essentials</a></li>
<li><a href="../../internal-cascade-api/internal-cascade-api-changelog/" class="sidebar__link">Internal Cascade API Changelog</a></li>
<li><a href="../../rest-api/operations/" class="sidebar__link">Operations</a></li>
<li><a href="../../publish-triggers/" class="sidebar__link">Publish Triggers</a></li>
<li><a href="./" class="sidebar__link sidebar__link--active" aria-current="page">Query Tool Directives</a></li>
<li><a href="../../soap-web-services-api/soap-web-services-changelog/" class="sidebar__link">SOAP Web Services Changelog</a></li>
<li><a href="../../soap-web-services-api/soap-web-services-operations/" class="sidebar__link">SOAP Web Services Operations</a></li>
<li><a href="../../system-pseudo-tags/" class="sidebar__link">System Pseudo-Tags</a></li>
<li><a href="../../rest-api/placeholders/auth/" class="sidebar__link">The {auth} placeholder</a></li>
<li><a href="../../rest-api/placeholders/identifier/" class="sidebar__link">The {identifier} placeholder</a></li>
<li><a href="../../rest-api/placeholders/wsdl/" class="sidebar__link">The {wsdl} placeholder</a></li>
<li><a href="../velocity-tools/" class="sidebar__link">Velocity Tools</a></li>
  </ul>
</div>
<div class="sidebar__section">
  <button class="sidebar__category" aria-expanded="false">
    Faqs
    <svg class="sidebar__chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="sidebar__pages" hidden>
    <li><a href="../../../faqs/" class="sidebar__link">Faqs Overview</a></li>
<li><a href="../../../faqs/database-errors/could-not-acquire-change-log-lock-or-waiting-for-changelog-lock.../" class="sidebar__link">&quot;Could not acquire change log lock&quot; or &quot;Waiting for changelog lock...&quot;</a></li>
<li><a href="../../../faqs/security/remember-me-cookied-login-vulnerabilities/" class="sidebar__link">&quot;Remember Me&quot; Cookied Login Vulnerabilities</a></li>
<li><a href="../../../faqs/wysiwyg/adding-a-caption-to-a-table/" class="sidebar__link">Adding a caption to a table</a></li>
<li><a href="../../../faqs/wysiwyg/adding-a-caption-to-an-image/" class="sidebar__link">Adding a caption to an image</a></li>
<li><a href="../../../faqs/wysiwyg/add-a-pdf-or-document-to-a-page/" class="sidebar__link">Adding a PDF to a page</a></li>
<li><a href="../../../faqs/wysiwyg/adding-a-table-header-and-footer/" class="sidebar__link">Adding a table header and footer</a></li>
<li><a href="../../../faqs/wysiwyg/add-an-image-to-a-page/" class="sidebar__link">Adding an image to a page</a></li>
<li><a href="../../../faqs/wysiwyg/adding-classes-to-links-images/" class="sidebar__link">Adding classes to links and images</a></li>
<li><a href="../../../faqs/wysiwyg/adding-classes-to-tables/" class="sidebar__link">Adding classes to tables</a></li>
<li><a href="../../../faqs/wysiwyg/adding-header-cells-to-a-table/" class="sidebar__link">Adding header cells to a table</a></li>
<li><a href="../../../faqs/publish-errors/asset-is-not-set-to-publish/" class="sidebar__link">Asset is not set to publish. Please enable publishing for this asset and try again.</a></li>
<li><a href="../../../faqs/troubleshooting/assets-not-appearing-in-index-blocks/" class="sidebar__link">Assets are not appearing in Index Blocks</a></li>
<li><a href="../../../faqs/common-errors/index/" class="sidebar__link">Common Error Messages</a></li>
<li><a href="../../../faqs/common-errors/comparison-method-violates-its-general-contract/" class="sidebar__link">Comparison method violates its general contract</a></li>
<li><a href="../../../faqs/development/configure-noindex-nofollow/" class="sidebar__link">Configuring a robots meta tag</a></li>
<li><a href="../../../faqs/wysiwyg/configuring-table-properties/" class="sidebar__link">Configuring table properties</a></li>
<li><a href="../../../faqs/publish-errors/could-not-connect-to-ftps-server-notafter/" class="sidebar__link">Could not connect to FTPS server: NotAfter</a></li>
<li><a href="../../../faqs/common-errors/could-not-create-index-writer/" class="sidebar__link">Could not create index writer</a></li>
<li><a href="../../../faqs/common-errors/could-not-get-file-content/" class="sidebar__link">Could not get file content for lucene indexing</a></li>
<li><a href="../../../faqs/publish-errors/could-not-put-file-with-path-path-onto-server-failure/" class="sidebar__link">Could not put file with path &#39;&#39; onto server: Failure</a></li>
<li><a href="../../../faqs/publish-errors/could-not-put-file-with-path-file-path-onto-server-permission-denied/" class="sidebar__link">Could not put file with path &#39;FILE_PATH&#39; onto server: Permission denied</a></li>
<li><a href="../../../faqs/common-errors/could-not-reset-lucene-directory/" class="sidebar__link">Could not reset lucene directory</a></li>
<li><a href="../../../faqs/wysiwyg/create-anchor-link/" class="sidebar__link">Creating an anchor link</a></li>
<li><a href="../../../faqs/security/cve-2020-1938-ghostcat/" class="sidebar__link">CVE-2020-1938 Ghostcat</a></li>
<li><a href="../../../faqs/security/cve-2021-4104/" class="sidebar__link">CVE-2021-4104</a></li>
<li><a href="../../../faqs/security/cve-2021-44228-log4shell/" class="sidebar__link">CVE-2021-44228 Log4Shell</a></li>
<li><a href="../../../faqs/security/cve-2021-45046-log4shell/" class="sidebar__link">CVE-2021-45046 Log4Shell</a></li>
<li><a href="../../../faqs/security/cve-2021-45105-log4shell/" class="sidebar__link">CVE-2021-45105 Log4Shell</a></li>
<li><a href="../../../faqs/security/cve-2022-22965-spring4shell/" class="sidebar__link">CVE-2022-22965 Spring4Shell</a></li>
<li><a href="../../../faqs/security/cve-2022-23302-jmssink/" class="sidebar__link">CVE-2022-23302 JMSSink</a></li>
<li><a href="../../../faqs/security/cve-2022-23305-jdbcappender/" class="sidebar__link">CVE-2022-23305 JDBCAppender</a></li>
<li><a href="../../../faqs/security/cve-2022-23307-chainsaw-package/" class="sidebar__link">CVE-2022-23307 Chainsaw Package</a></li>
<li><a href="../../../faqs/security/cve-2025-24813/" class="sidebar__link">CVE-2025-24813</a></li>
<li><a href="../../../faqs/database-errors/index/" class="sidebar__link">Database Errors</a></li>
<li><a href="../../../faqs/development/index/" class="sidebar__link">Development</a></li>
<li><a href="../../../faqs/troubleshooting/discarding-the-index-block-rendering-cache/" class="sidebar__link">Discarding the Index Block Rendering Cache</a></li>
<li><a href="../../../faqs/common-errors/error-constructing-implementation/" class="sidebar__link">Error constructing implementation</a></li>
<li><a href="../../../faqs/database-errors/error-executing-sql-delete-from-cxml_history_item/" class="sidebar__link">Error executing SQL DELETE FROM `cxml_history_item`</a></li>
<li><a href="../../../faqs/publish-errors/error-occurred-during-ftp-transport-accept-timed-out/" class="sidebar__link">Error occurred during FTP transport: Accept timed out</a></li>
<li><a href="../../../faqs/common-errors/exception-invoking-method-getavailableids-in-class-sun.util.calendar.zoneinfo/" class="sidebar__link">Exception invoking method &#39;getAvailableIDs&#39; in class sun.util.calendar.ZoneInfo</a></li>
<li><a href="../../../faqs/index/" class="sidebar__link">FAQs</a></li>
<li><a href="../../../faqs/development/filtering-queries-based-on-structured-data-values/" class="sidebar__link">Filtering queries based on multi-value fields</a></li>
<li><a href="../../../faqs/general/index/" class="sidebar__link">General / How To</a></li>
<li><a href="../../../faqs/troubleshooting/generate-a-har-file/" class="sidebar__link">Generate a HAR file</a></li>
<li><a href="../../../faqs/troubleshooting/generating-a-thread-dump/" class="sidebar__link">Generating a thread dump</a></li>
<li><a href="../../../faqs/development/getting-started-with-rest/" class="sidebar__link">Getting started with REST</a></li>
<li><a href="../../../faqs/general/granting-access-specific-folders-users-groups/" class="sidebar__link">Granting Access to Specific Folders for Users/Groups</a></li>
<li><a href="../../../faqs/common-errors/header-message-of-length-received/" class="sidebar__link">Header message of length [] received but the packetSize is only []</a></li>
<li><a href="../../../faqs/general/check-what-user-can-do-in-site/" class="sidebar__link">How can I check what a User can do in a specific Site?</a></li>
<li><a href="../../../faqs/troubleshooting/how-can-i-enable-request-logging-for-the-cms/" class="sidebar__link">How can I enable request logging for Cascade CMS?</a></li>
<li><a href="../../../faqs/general/how-can-i-find-the-os-account-running-cascade-cms/" class="sidebar__link">How can I find the O/S account running Cascade CMS?</a></li>
<li><a href="../../../faqs/troubleshooting/find-java-installation/" class="sidebar__link">How can I find which Java installation my Cascade CMS instance is using?</a></li>
<li><a href="../../../faqs/general/how-can-i-generate-a-cron-expression-for-my-scheduled-publishes/" class="sidebar__link">How can I generate a cron expression for my scheduled publishes?</a></li>
<li><a href="../../../faqs/development/redesign-a-site-existing-content/" class="sidebar__link">How can I redesign a site using our existing content?</a></li>
<li><a href="../../../faqs/development/set-up-canonical-tags/" class="sidebar__link">How can I set up canonical tags?</a></li>
<li><a href="../../../faqs/general/who-edited-or-published-a-page/" class="sidebar__link">How can I tell who edited or published a page?</a></li>
<li><a href="../../../faqs/troubleshooting/view-largest-binary-files-in-database/" class="sidebar__link">How can I view the largest binary files within my database?</a></li>
<li><a href="../../../faqs/development/access-chosen-asset/" class="sidebar__link">How do I access a chooser field&#39;s chosen asset?</a></li>
<li><a href="../../../faqs/development/access-dynamic-custom-metadata-fields-velocity/" class="sidebar__link">How do I access Dynamic / Custom Metadata Fields in Velocity?</a></li>
<li><a href="../../../faqs/development/add-title-tag-to-page/" class="sidebar__link">How do I add a &quot;title&quot; tag to my page?</a></li>
<li><a href="../../../faqs/development/add-code-snippet/" class="sidebar__link">How do I add a code snippet to my content?</a></li>
<li><a href="../../../faqs/development/apply-css/" class="sidebar__link">How do I apply CSS?</a></li>
<li><a href="../../../faqs/general/change-name-or-url-of-site/" class="sidebar__link">How do I change the name or URL of my site?</a></li>
<li><a href="../../../faqs/general/configure-301-redirects/" class="sidebar__link">How do I configure 301 Redirects?</a></li>
<li><a href="../../../faqs/general/control-user-access-to-folders-and-assets/" class="sidebar__link">How do I control User access to Folders and assets?</a></li>
<li><a href="../../../faqs/development/create-calling-page-index-block/" class="sidebar__link">How do I create a &quot;calling page&quot; Index Block?</a></li>
<li><a href="../../../faqs/development/create-xml-output-for-a-page/" class="sidebar__link">How do I create an XML output for a page?</a></li>
<li><a href="../../../faqs/general/delete-a-site/" class="sidebar__link">How do I delete a site?</a></li>
<li><a href="../../../faqs/general/how-do-i-delete-a-workflow/" class="sidebar__link">How do I delete a Workflow?</a></li>
<li><a href="../../../faqs/general/how-do-i-determine-where-assets-will-be-published/" class="sidebar__link">How do I determine where assets will be published?</a></li>
<li><a href="../../../faqs/general/where-to-edit-content-certain-region/" class="sidebar__link">How do I edit content or find out where to edit a certain region?</a></li>
<li><a href="../../../faqs/troubleshooting/enable-debug-logging/" class="sidebar__link">How do I enable DEBUG logging?</a></li>
<li><a href="../../../faqs/general/give-user-or-group-access-to-site/" class="sidebar__link">How do I give a User or Group access to a Site?</a></li>
<li><a href="../../../faqs/development/include-page-id-in-contents/" class="sidebar__link">How do I include a page&#39;s ID in its contents?</a></li>
<li><a href="../../../faqs/development/include-open-graph-or-twitter-card-meta-tags/" class="sidebar__link">How do I include Open Graph or Twitter card meta tags in my page?</a></li>
<li><a href="../../../faqs/development/make-a-sitemap/" class="sidebar__link">How do I make an XML sitemap?</a></li>
<li><a href="../../../faqs/development/make-css-classes-available-in-wysiwyg/" class="sidebar__link">How do I make CSS classes available in the WYSIWYG formats drop-down menu?</a></li>
<li><a href="../../../faqs/general/publish-changes-to-a-block/" class="sidebar__link">How do I publish changes to a block?</a></li>
<li><a href="../../../faqs/general/rebuild-search-indexes/" class="sidebar__link">How do I rebuild my search indexes?</a></li>
<li><a href="../../../faqs/general/how-do-i-rename-an-asset/" class="sidebar__link">How do I rename an asset?</a></li>
<li><a href="../../../faqs/general/how-do-i-reorder-items-in-a-navigation-menu/" class="sidebar__link">How do I reorder items in a navigation menu?</a></li>
<li><a href="../../../faqs/general/restore-from-trash/" class="sidebar__link">How do I restore something I deleted from the trash / recycle bin?</a></li>
<li><a href="../../../faqs/development/sort-on-calendar-field/" class="sidebar__link">How do I sort on a Calendar field?</a></li>
<li><a href="../../../faqs/general/unlock-page-or-asset/" class="sidebar__link">How do I unlock a page or asset?</a></li>
<li><a href="../../../faqs/general/how-do-i-unpublish-an-asset-that-no-longer-exists-in-the-cms-two/" class="sidebar__link">How Do I Unpublish An Asset That No Longer Exists In The CMS?</a></li>
<li><a href="../../../faqs/general/upload-a-folder/" class="sidebar__link">How do I upload a folder?</a></li>
<li><a href="../../../faqs/development/view-sample-xml-when-editing-format/" class="sidebar__link">How do I view sample XML when editing a Format?</a></li>
<li><a href="../../../faqs/general/max-asset-versions-setting/" class="sidebar__link">How does the Max Asset Versions setting affect existing versions?</a></li>
<li><a href="../../../faqs/development/update-deprecated-velocity-code/" class="sidebar__link">How to update deprecated Velocity code</a></li>
<li><a href="../../../faqs/publish-errors/i-wont-open-a-connection-to-ip-address-1-only-to-ip-address-2/" class="sidebar__link">I won&#39;t open a connection to (only to )</a></li>
<li><a href="../../../faqs/wysiwyg/inserting-a-video/" class="sidebar__link">Inserting a video</a></li>
<li><a href="../../../faqs/publish-errors/invalid-privatekey-error-when-publishing-via-sftp/" class="sidebar__link">Invalid privatekey error when publishing via SFTP</a></li>
<li><a href="../../../faqs/common-errors/an-invalid-xml-character-was-found-in-the-element-content-of-the-document/" class="sidebar__link">Invalid XML character was found in the element content of the document</a></li>
<li><a href="../../../faqs/common-errors/prefix-o-for-element-op-is-not-bound/" class="sidebar__link">Invalid XML: The prefix &quot;o&quot; for element &quot;o:p&quot; is not bound</a></li>
<li><a href="../../../faqs/common-errors/login-failed/" class="sidebar__link">Login Failed</a></li>
<li><a href="../../../faqs/database-errors/public-key-retrieval-is-not-allowed/" class="sidebar__link">MySQL 8: Public Key Retrieval is not allowed</a></li>
<li><a href="../../../faqs/database-errors/mysql-cant-create-table/" class="sidebar__link">MySQL: Can&#39;t create table</a></li>
<li><a href="../../../faqs/database-errors/mysql-cant-createwrite-to-file/" class="sidebar__link">MySQL: Can&#39;t create/write to file</a></li>
<li><a href="../../../faqs/publish-errors/no-destinations-or-wp-connectors-available/" class="sidebar__link">No Destinations or WordPress Connectors available</a></li>
<li><a href="../../../faqs/database-errors/invalid-lob-locator-specified/" class="sidebar__link">ORA-22275: invalid LOB locator specified</a></li>
<li><a href="../../../faqs/development/output-content-as-json/" class="sidebar__link">Output content as JSON</a></li>
<li><a href="../../../faqs/database-errors/packet-for-query-is-too-large/" class="sidebar__link">Packet for query is too large</a></li>
<li><a href="../../../faqs/common-errors/could-not-transform-with-script-format/" class="sidebar__link">PageRenderException: Could not transform with Script format</a></li>
<li><a href="../../../faqs/common-errors/parameters-missing/" class="sidebar__link">Parameters missing</a></li>
<li><a href="../../../faqs/publish-errors/permissions-issues-filesystem-transports/" class="sidebar__link">Permissions issues when publishing to Filesystem Transports</a></li>
<li><a href="../../../faqs/publish-errors/problems-connecting-via-sftp-to-solarwinds-serv-u-servers/" class="sidebar__link">Problems connecting via SFTP to Solarwinds Serv-U servers</a></li>
<li><a href="../../../faqs/publish-errors/index/" class="sidebar__link">Publish Errors</a></li>
<li><a href="../../../faqs/general/scheduled-publishing-for-individual-assets/" class="sidebar__link">Scheduled publishing for individual assets</a></li>
<li><a href="../../../faqs/common-errors/search-failed-no-segments-file-found/" class="sidebar__link">Search failed: no segments file found</a></li>
<li><a href="../../../faqs/troubleshooting/search-isnt-returning-expected-results/" class="sidebar__link">Search isn&#39;t returning expected results</a></li>
<li><a href="../../../faqs/common-errors/secure-ldap-sync-fails/" class="sidebar__link">Secure LDAP sync fails after upgrade to Cascade CMS v8.11</a></li>
<li><a href="../../../faqs/security/index/" class="sidebar__link">Security</a></li>
<li><a href="../../../faqs/publish-errors/read-timed-out/" class="sidebar__link">SFTP: java.net.SocketTimeoutException: Read timed out</a></li>
<li><a href="../../../faqs/common-errors/workflow-is-required/" class="sidebar__link">Sorry, workflow is required to be able to continue but no workflows are available to you.</a></li>
<li><a href="../../../faqs/general/styles-not-loading-for-404-pages/" class="sidebar__link">Styles not loading for 404 pages</a></li>
<li><a href="../../../faqs/common-errors/table-headers-are-poorly-structured/" class="sidebar__link">Table headers are poorly structured</a></li>
<li><a href="../../../faqs/development/testing-for-an-empty-wysiwyg-field/" class="sidebar__link">Testing for an empty WYSIWYG field</a></li>
<li><a href="../../../faqs/database-errors/the-driver-could-not-establish-a-secure-connection-to-sql-server-by-using-secure-sockets-layer-ssl-encryption/" class="sidebar__link">The driver could not establish a secure connection to SQL Server by using Secure Sockets Layer (SSL) encryption</a></li>
<li><a href="../../../faqs/database-errors/the-driver-could-not-establish-a-secure-connection-to-sql-server-by-using-secure-sockets-layer-ssl-encryption.-error-unexpected-rethrowing/" class="sidebar__link">The driver could not establish a secure connection to SQL Server by using Secure Sockets Layer (SSL) encryption. Error: &quot;Unexpected rethrowing&quot;</a></li>
<li><a href="../../../faqs/publish-errors/folder-hierarchy-does-not-allow-this-asset-to-be-published/" class="sidebar__link">The folder hierarchy does not allow this asset to be published</a></li>
<li><a href="../../../faqs/common-errors/index-block-renders-too-much-data/" class="sidebar__link">The index block with path {path} renders too much data</a></li>
<li><a href="../../../faqs/publish-errors/no-publishable-configurations/" class="sidebar__link">This asset cannot be published because there are no publishable configurations</a></li>
<li><a href="../../../faqs/troubleshooting/index/" class="sidebar__link">Troubleshooting</a></li>
<li><a href="../../../faqs/publish-errors/unsupported-or-unrecognized-ssl-message/" class="sidebar__link">Unsupported or unrecognized SSL message</a></li>
<li><a href="../../../faqs/general/locate-publish-notifications/" class="sidebar__link">Where can I find publish notifications?</a></li>
<li><a href="../../../faqs/troubleshooting/cascade-cms-log-files/" class="sidebar__link">Where can I find the Cascade CMS log files?</a></li>
<li><a href="../../../faqs/general/which-algorithms-are-supported-for-sftp/" class="sidebar__link">Which algorithms are supported for SFTP?</a></li>
<li><a href="../../../faqs/troubleshooting/asset-does-not-exist/" class="sidebar__link">Why am I seeing &#39;Asset does not exist&#39; message in my Publish Notification?</a></li>
<li><a href="../../../faqs/development/system-region-tags-in-published-content/" class="sidebar__link">Why am I seeing tags around my published content?</a></li>
<li><a href="../../../faqs/troubleshooting/g-tags-in-wysiwyg-editor/" class="sidebar__link">Why are &quot;g&quot; tags appearing in the WYSIWYG editor?</a></li>
<li><a href="../../../faqs/troubleshooting/changes-not-appearing-on-site/" class="sidebar__link">Why are my changes not appearing on the web site?</a></li>
<li><a href="../../../faqs/development/css-background-images-not-displayed/" class="sidebar__link">Why aren&#39;t my CSS background images being displayed?</a></li>
<li><a href="../../../faqs/troubleshooting/user-upload-images-in-wysiwyg-or-file-chooser/" class="sidebar__link">Why can&#39;t my user upload images in the WYSIWYG or file chooser?</a></li>
<li><a href="../../../faqs/troubleshooting/users-access-the-full-search/" class="sidebar__link">Why can&#39;t my users access the full search feature?</a></li>
<li><a href="../../../faqs/troubleshooting/users-add-content-menu/" class="sidebar__link">Why can&#39;t my users see anything in the Add Content menu?</a></li>
<li><a href="../../../faqs/troubleshooting/index-block-stops-indexing-assets/" class="sidebar__link">Why does my Index Block stop indexing assets at a certain point?</a></li>
<li><a href="../../../faqs/development/working-with-namespaces-in-velocity/" class="sidebar__link">Working with namespaces in Velocity</a></li>
<li><a href="../../../faqs/development/working-with-server-side-includes/" class="sidebar__link">Working with Server Side Includes</a></li>
<li><a href="../../../faqs/wysiwyg/index/" class="sidebar__link">WYSIWYG</a></li>
<li><a href="../../../faqs/publish-errors/not-authorized-to-schedule-future-publish-dates/" class="sidebar__link">You are not authorized to schedule future publish dates</a></li>
<li><a href="../../../faqs/publish-errors/you-cannot-publish-or-unpublish-this-asset-because-there-are-no-destinations-or-wordpress-connectors-available/" class="sidebar__link">You cannot publish (or unpublish) this asset because there are no Destinations or WordPress Connectors available.</a></li>
<li><a href="../../../faqs/common-errors/workflow-is-unable-to-proceed/" class="sidebar__link">Your roles do not allow you to advance workflow</a></li>
  </ul>
</div>
      </nav>
    </aside>

    <main id="main-content" class="main">
      <article class="content">
        <nav class="breadcrumb" aria-label="Breadcrumb">
  <ol class="breadcrumb__list">
    <li class="breadcrumb__item"><a href="../../.././" class="breadcrumb__link">Home</a></li>
    <li class="breadcrumb__item"><a href="../../" class="breadcrumb__link">Developing In Cascade</a></li>
    <li class="breadcrumb__item breadcrumb__item--current" aria-current="page">Query Tool Directives</li>
  </ol>
</nav>
        <header class="content__header">
          <span class="content__category-label">Developing In Cascade</span>
          <h1 class="content__title">Query Tool Directives</h1>
        </header>
        <div class="content__body">
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-1">Overview</h2>
                        <p>Introduced in Cascade CMS 8.26, Query Directives are an alternative to the <code>.execute()</code> method on the Query API. They process results one asset at a time instead of loading everything into a list, which means they can handle up to <strong>100,000</strong> results (compared to the 2,000 limit with <code>.execute()</code>).</p>
<p>There are three directives:</p>
<ul>
<li><code>#queryexecute</code> â€“ iterate over results and output content for each asset</li>
<li><code>#queryfilter</code> â€“ apply custom filtering logic before <code>maxResults()</code> is applied</li>
<li><code>#querysortvalue</code> â€“ define a custom sort value before <code>maxResults()</code> is applied</li>
</ul>
<p>All three use the same basic pattern: pass a query object and an asset variable, write your logic in the body, and close with <code>#end</code>.</p>
<div class="callout callout--tip">
  <div class="callout__content">
    <p class="callout__title">Tip</p>
    <p>Use <code>$enabledCustomDirectives</code> to check which custom directives are available in your CMS environment.</p>
  </div>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-2">When to use directives</h2>
                        <div class="table-wrapper">
  <table class="table table--striped"><caption>Quick decision guide: .execute() vs directives</caption>
<thead>
<tr>
<th scope="col">Scenario</th>
<th scope="col">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Results under 2,000 with no custom filtering or sorting</td>
<td><code>.execute()</code></td>
</tr>
<tr>
<td>Need more than 2,000 results</td>
<td><code>#queryexecute</code></td>
</tr>
<tr>
<td>Need to filter on values not available via built-in query methods</td>
<td><code>#queryfilter</code></td>
</tr>
<tr>
<td>Need to sort by structured data, dynamic metadata, or computed values</td>
<td><code>#querysortvalue</code></td>
</tr>
<tr>
<td>Under 2,000 results but need custom filtering or sorting</td>
<td><code>#queryfilter</code> / <code>#querysortvalue</code> + <code>.execute()</code></td>
</tr>
<tr>
<td>Large dataset with custom filter + sort + output</td>
<td>All three combined</td>
</tr>
</tbody>
</table>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-3">#queryexecute</h2>
                        <p>Replaces the <code>.execute()</code> + <code>#foreach</code> pattern. The directive iterates over results directly, processing one asset at a time. Supports <code>maxResults()</code> up to <strong>100,000</strong>.</p>
<div class="table-wrapper">
  <table class="table table--striped"><caption>Available arguments for #queryexecute.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute and output for each asset.</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout--warning">
  <div class="callout__content">
    <p class="callout__title">Important</p>
    <p>Unlike <code>#foreach</code>, this directive clears the previous asset from memory on each iteration. This means <code>$foreach.count</code>, <code>$foreach.hasNext</code>, <code>$foreach.index</code>, and other loop variables are <strong>not available</strong>. If you need a counter or first-iteration check, manage it yourself with a <code>#set</code> variable.</p>
  </div>
</div>
<h3>Basic usage</h3>
<p>Build a query, then pass it to <code>#queryexecute</code> instead of calling <code>.execute()</code>.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">## Build the query (do NOT call .execute())
#set ($query = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc"))

## Iterate with the directive
#queryexecute($query, $page)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<h3>Sitemap generation</h3>
<p>Query directives are well suited for sitemaps where the result set can be very large.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Default-Page").indexableOnly(true).preloadDynamicMetadata())
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt;
  #queryexecute($query, $page)
    &lt;url&gt;
      &lt;loc&gt;https://yoursite.com${page.path}.html&lt;/loc&gt;
    &lt;/url&gt;
  #end
&lt;/urlset&gt;</code></pre>
</div>
<h3>Large datasets with preloaded data</h3>
<p>When working with structured data across many results, preload it on the query to avoid per-asset database round trips.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().maxResults(5000).sortBy("startDate").sortDirection("asc"))

#queryexecute($query, $event)
  #set ($start = $event.getStructuredDataNode("startDateTime").textValue)
  #set ($title = $event.metadata.title)
  &lt;div class="event-card"&gt;
    &lt;h3&gt;$title&lt;/h3&gt;
    &lt;span&gt;$start&lt;/span&gt;
  &lt;/div&gt;
#end</code></pre>
</div>
<h3>Cross-site query</h3>
<p>Query across all sites for assets using a shared Content Type.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("site://Global/Shared Page").searchAcrossAllSites().preloadDynamicMetadata().maxResults(10000))

#queryexecute($query, $page)
  &lt;li&gt;
    &lt;a href="${page.link}"&gt;${page.metadata.title}&lt;/a&gt;
    &lt;small&gt;(${page.siteName})&lt;/small&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
<h3>JSON feed</h3>
<p>Since loop variables aren't available, use a flag variable like <code>$isFirstIteration</code> for comma separation in JSON output.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set($query = $_.query().byContentType("Event").preloadStructuredData().sortBy("startDate"))
#set($isFirstIteration = true)

[
#queryexecute($query, $event)
    #if(!$isFirstIteration),#end
    #set($title = $_EscapeTool.java($event.metadata.title.trim()))
    #set($date  = $event.getStructuredDataNode("event-date").textValue)
    {
        "title": "${title}",
        "date":  "${date}",
        "url":   ""
    }
    #set($isFirstIteration = false)
#end
]</code></pre>
</div>
<p>The key pattern: <code>#if(!$isFirstIteration),#end</code> outputs a comma before every entry except the first, replacing what you'd normally do with <code>$foreach.hasNext</code>.</p>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-4">#queryfilter</h2>
                        <p>Executes body logic on each asset matching a query <em>before</em> <code>maxResults()</code> is applied. If the body logic returns <code>true</code>, the asset is included in the results.</p>
<div class="table-wrapper">
  <table class="table table--striped"><caption>Available arguments for #queryfilter.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute. Must return the exact string <code>true</code> to include the asset.</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout--warning">
  <div class="callout__content">
    <p class="callout__title">Note</p>
    <p>Built-in filtering methods result in faster performance and this directive should only be used for scenarios where there is no built-in method. For example, <code>.bySiteName</code> will be faster than using <code>#queryfilter</code> with Site name comparison logic.</p>
  </div>
</div>
<div class="callout callout--tip">
  <div class="callout__content">
    <p class="callout__title">Tip</p>
    <p>You can move your logic into <code>#queryexecute</code> temporarily to test the functionality and ensure that your body logic returns the exact string <code>true</code>.</p>
  </div>
</div>
<div class="callout callout--tip">
  <div class="callout__content">
    <p class="callout__title">Tip</p>
    <p>The preferred way to return a value from the filter body is to use <code>#set</code> to capture the result, then output it:
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = $asset.path.contains("index"))
  $result
#end</code></pre>
</div>
This pattern handles negation and multiple conditions cleanly without needing <code>#if</code>/<code>true</code>/<code>#end</code>.</p>
  </div>
</div>
<h3>Filter by path pattern</h3>
<p>Only include index pages from the query results.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  $asset.path.contains("index")
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Filter by structured data value</h3>
<p>Include only assets where a structured data checkbox has a specific value. This is useful for multi-value fields where built-in methods can't filter directly.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").preloadStructuredData())

#queryfilter($query, $asset)
  $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;div class="featured-news"&gt;
    &lt;h3&gt;${page.metadata.title}&lt;/h3&gt;
    &lt;p&gt;${page.metadata.summary}&lt;/p&gt;
  &lt;/div&gt;
#end</code></pre>
</div>
<h3>Filter by dynamic metadata</h3>
<p>Include only assets where a dynamic metadata field matches a condition.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Page").preloadDynamicMetadata())

#queryfilter($query, $asset)
  $asset.metadata.getDynamicField("display-in-nav").value.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;li&gt;&lt;a href="${page.link}"&gt;${page.metadata.displayName}&lt;/a&gt;&lt;/li&gt;
#end</code></pre>
</div>
<h3>Filter by empty or populated field</h3>
<p>Use <code>$_PropertyTool.isNotEmpty()</code> to include only assets where a field has a value. Negate it to find assets where a field is empty.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">## Only pages where the author field is populated
#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  $_PropertyTool.isNotEmpty($asset.metadata.author)
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title} &amp;mdash; ${page.metadata.author}&lt;/li&gt;
#end</code></pre>
</div>
<p>To find assets where a field is <em>empty</em>, negate the check with <code>#set</code>:</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = !$_PropertyTool.isNotEmpty($asset.metadata.author))
  $result
#end</code></pre>
</div>
<h3>Multiple conditions</h3>
<p>Use <code>#set</code> to combine conditions with <code>&amp;&amp;</code> or <code>||</code>. The result is captured as a boolean and output directly.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData())

#queryfilter($query, $asset)
  #set($result = $asset.path.contains("index") &amp;&amp; $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<p>OR logic works the same way:</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = $asset.metadata.title.contains("News") || $asset.metadata.title.contains("Events"))
  $result
#end</code></pre>
</div>
<h3>Exclude pattern</h3>
<p>To exclude assets matching a condition, negate the check.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  #set($result = !$asset.path.contains("/archive/"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-5">#querysortvalue</h2>
                        <p>Executes body logic on each asset to determine the sort value <em>before</em> <code>maxResults()</code> is applied. This is an alternative to <code>.sortBy()</code> and can be used with both <code>#queryexecute</code> and <code>.execute()</code>.</p>
<div class="table-wrapper">
  <table class="table table--striped"><caption>Available arguments for #querysortvalue.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute. The return value is used as the sort key.</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout--warning">
  <div class="callout__content">
    <p class="callout__title">Note</p>
    <p>Built-in sorting methods result in faster performance. For example, <code>.sortBy("name")</code> will be faster than using <code>#querysortvalue</code> with <code>$asset.name</code> as the logic.</p>
  </div>
</div>
<div class="callout callout--tip">
  <div class="callout__content">
    <p class="callout__title">Tips</p>
    <p><ul>
<li>This directive sorts by <strong>string</strong> only. When sorting numbers, use <code>$_NumberTool.withPadding</code> to ensure results sort correctly.</li>
<li>This directive respects the value passed into <code>.sortDirection()</code> on the query.</li>
</ul></p>
  </div>
</div>
<h3>Sort by metadata title</h3>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#querysortvalue($query, $asset)
  $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Sort by structured data text field</h3>
<p>Sort by a text value stored in structured data rather than a metadata field.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("title").textValue
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.getStructuredDataNode("title").textValue}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Numeric sorting with $_NumberTool.withPadding</h3>
<p>Since <code>#querysortvalue</code> sorts by string, numeric values need padding to sort correctly (e.g., "5" would sort after "10" without padding).</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Course").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $_NumberTool.withPadding($asset.getStructuredDataNode("course-number").textValue)
#end

#queryexecute($query, $course)
  &lt;li&gt;${course.getStructuredDataNode("course-number").textValue} - ${course.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Multi-level sorting</h3>
<p>Since sorting is string-based, you can concatenate multiple values to sort by more than one field. The first value acts as the primary sort, the second as the tiebreaker, and so on.</p>
<h4>Alphabetical by last name, then first name</h4>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Staff").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("last-name").textValue $asset.getStructuredDataNode("first-name").textValue
#end

#queryexecute($query, $person)
  &lt;li&gt;${person.getStructuredDataNode("last-name").textValue}, ${person.getStructuredDataNode("first-name").textValue}&lt;/li&gt;
#end</code></pre>
</div>
<h4>By department number, then course name</h4>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Course").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $_NumberTool.withPadding($asset.getStructuredDataNode("department-number").textValue) $asset.metadata.title
#end

#queryexecute($query, $course)
  &lt;li&gt;${course.getStructuredDataNode("department-number").textValue} - ${course.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<p>Note the <code>$_NumberTool.withPadding</code> on the department number. Without it, department "5" would sort after "10" since it's comparing strings.</p>
<h4>By author, then title</h4>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").sortDirection("asc").maxResults(50))

#querysortvalue($query, $asset)
  $asset.metadata.author $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.author} &amp;mdash; ${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Sort by date stored in structured data</h3>
<p>Date strings like <code>01-15-2024 02:30:00 PM</code> won't sort chronologically as plain strings because the month comes first. Convert the value to epoch milliseconds with <code>$_DateTool</code> so the sort is truly chronological.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("desc").maxResults(20))

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

#queryexecute($query, $event)
  &lt;li&gt;
    ${event.metadata.title}
    &lt;span&gt;${event.getStructuredDataNode("event-date").textValue}&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
<p>The format string passed to <code>$_DateTool.toDate()</code> must match the format stored in your data definition. Adjust it to match your field's format.</p>
<h3>Sort descending</h3>
<p>The directive respects <code>.sortDirection()</code>. Set it on the query object before using <code>#querysortvalue</code>.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").sortDirection("desc"))

#querysortvalue($query, $asset)
  $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-6">Combining directives</h2>
                        
<p>All three directives can be used together on the same query. The order of operations is: <code>#queryfilter</code> runs first to narrow the results, then <code>#querysortvalue</code> determines the sort order, and finally <code>#queryexecute</code> outputs the results up to the <code>maxResults()</code> limit.</p>
<h3>Full example: filtered, sorted event listing</h3>
<p>Query all events, filter to only featured ones, sort by a structured data date field, and output the first 50.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">## Build the query
#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("asc").maxResults(50))

## Filter: only featured events
#queryfilter($query, $asset)
  $asset.getStructuredDataNode("is-featured").textValue.contains("Yes")
#end

## Sort: by event date stored in structured data
#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("event-date").textValue
#end

## Output
&lt;ul&gt;
#queryexecute($query, $event)
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;${event.getStructuredDataNode("event-date").textValue}&lt;/span&gt;
  &lt;/li&gt;
#end
&lt;/ul&gt;</code></pre>
</div>
<h3>Date range filter with chronological sorting</h3>
<p>Filter to events within a specific date range and sort them chronologically. The filter parses each date into epoch milliseconds for comparison, and the sort does the same for ordering.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("asc").maxResults(100))
#set ($rangeStart = $_DateTool.toDate("yyyy-MM-dd", "2024-01-01").getTime())
#set ($rangeEnd = $_DateTool.toDate("yyyy-MM-dd", "2024-12-31").getTime())

## Filter: only events in 2024
#queryfilter($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($ts = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt).getTime())
    #if($ts &gt;= $rangeStart &amp;&amp; $ts &lt;= $rangeEnd)
      true
    #end
  #end
#end

## Sort: chronological by event date
#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

## Output with formatted date
#queryexecute($query, $event)
  #set ($dt = $event.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  #set ($formatted = $_DateTool.format("MMMM d, yyyy", $date))
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;$formatted&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>

<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-7">In-depth examples</h2>
                        
<p>These examples demonstrate advanced patterns that build on the basics above. They reference a Content Type with the following fields. Adapt the content type path and field names to match your own setup.</p>
<ul>
<li><strong>Structured data</strong>: <code>title</code> (text), <code>event-date</code> (datetime in <code>MM-dd-yyyy hh:mm:ss a</code> format), <code>asset-chooser</code> (page chooser)</li>
<li><strong>Dynamic metadata</strong>: <code>multiselect</code> (multi-select), <code>checkbox</code> (checkbox), <code>department</code> (dropdown), <code>radio</code> (radio), <code>noindex</code> (radio)</li>
<li><strong>Standard metadata</strong>: title, author, displayName, summary, description, teaser, keywords, startDate, endDate</li>
</ul>
<h3>Filtering</h3>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-1">
    <span class="accordion__title">Filter by all values in a multi-select field</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-1" role="region" hidden>
    <div class="accordion__content">
<p>Check that a multi-value field contains every expected value using multiple <code>.contains()</code> calls joined with <code>&amp;&amp;</code>.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().maxResults(-1))

#queryfilter($query, $asset)
  #set ($cb = $asset.metadata.getDynamicField("checkbox").value)
  #set($result = $cb.contains("Easy") &amp;&amp; $cb.contains("Fast") &amp;&amp; $cb.contains("Cheap"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-2">
    <span class="accordion__title">Combine structured data, dynamic metadata, and standard metadata</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-2" role="region" hidden>
    <div class="accordion__content">
<p>Filter using fields from three different sources in one condition. Preload both structured data and dynamic metadata on the query.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().preloadDynamicMetadata().maxResults(-1))

#queryfilter($query, $asset)
  #set($result = $_PropertyTool.isNotEmpty($asset.getStructuredDataNode("event-date").textValue) &amp;&amp; $asset.metadata.getDynamicField("checkbox").value.contains("Easy") &amp;&amp; $asset.getStructuredDataNode("title").textValue.contains("Guide"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.getStructuredDataNode("title").textValue}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Sorting</h3>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-3">
    <span class="accordion__title">Sort by field value, then by date chronologically</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-3" role="region" hidden>
    <div class="accordion__content">
<p>Concatenate a text field with epoch milliseconds for a two-level sort. The text field acts as the primary sort, and the date as the tiebreaker.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().preloadDynamicMetadata().sortDirection("asc").maxResults(30))

#querysortvalue($query, $asset)
  #set ($group = $asset.metadata.getDynamicField("department").value)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${group} ${date.getTime()}
  #else
    ${group} 0
  #end
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.getDynamicField("department").value} &amp;mdash; ${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Combined</h3>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-4">
    <span class="accordion__title">Most recent pages in a filtered category</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-4" role="region" hidden>
    <div class="accordion__content">
<p>Combine <code>#queryfilter</code> to narrow by category, <code>#querysortvalue</code> to sort by date descending, and <code>maxResults(10)</code> to take only the top 10.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().sortDirection("desc").maxResults(10))

#queryfilter($query, $asset)
  $asset.metadata.title.contains("Science")
#end

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-5">
    <span class="accordion__title">Three-field filter with two-field sort</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-5" role="region" hidden>
    <div class="accordion__content">
<p>Filter on three conditions (dynamic metadata + standard metadata), then sort by two concatenated fields.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().preloadDynamicMetadata().sortDirection("asc").maxResults(25))

#queryfilter($query, $asset)
  #set($result = $asset.metadata.getDynamicField("checkbox").value.contains("Fast") &amp;&amp; $asset.metadata.getDynamicField("noindex").value.contains("No") &amp;&amp; $_PropertyTool.isNotEmpty($asset.metadata.summary))
  $result
#end

#querysortvalue($query, $asset)
  $asset.metadata.getDynamicField("department").value $asset.metadata.author
#end

#queryexecute($query, $page)
  &lt;li&gt;
    ${page.metadata.getDynamicField("department").value} &amp;mdash;
    ${page.metadata.author} &amp;mdash;
    ${page.metadata.title}
  &lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-6">
    <span class="accordion__title">Group results under dynamic headers</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-6" role="region" hidden>
    <div class="accordion__content">
<p>Sort by the grouping field so identical values are adjacent, then detect when the value changes to insert a header.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().sortDirection("asc").maxResults(50))

#querysortvalue($query, $asset)
  $asset.metadata.getDynamicField("department").value $asset.metadata.title
#end

#set ($currentGroup = "")
#queryexecute($query, $page)
  #set ($group = $page.metadata.getDynamicField("department").value)
  #if($group != $currentGroup)
    &lt;h3&gt;$group&lt;/h3&gt;
    #set ($currentGroup = $group)
  #end
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Advanced patterns</h3>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-7">
    <span class="accordion__title">Aggregate counts by field value</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-7" role="region" hidden>
    <div class="accordion__content">
<p>Use a map to count how many pages have each value in a field. Arithmetic (<code>+</code>) only works inside <code>#set</code> directives, not inside method arguments like <code>.put()</code>.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().maxResults(-1))
#set ($counts = {"Yes": 0, "No": 0, "Maybe": 0})

#queryexecute($query, $page)
  #set ($val = $page.metadata.getDynamicField("radio").value)
  #if($val.contains("Yes"))
    #set ($n = $counts.get("Yes") + 1)
    #set ($dummy = $counts.put("Yes", $n))
  #elseif($val.contains("No"))
    #set ($n = $counts.get("No") + 1)
    #set ($dummy = $counts.put("No", $n))
  #elseif($val.contains("Maybe"))
    #set ($n = $counts.get("Maybe") + 1)
    #set ($dummy = $counts.put("Maybe", $n))
  #end
#end
Yes: $counts.get("Yes"), No: $counts.get("No"), Maybe: $counts.get("Maybe")</code></pre>
</div>
    </div>
  </div>
</div>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-8">
    <span class="accordion__title">Parse, sort, and format dates for display</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-8" role="region" hidden>
    <div class="accordion__content">
<p>Filter to pages with a date, sort chronologically using epoch milliseconds, then format the date for readable output with <code>$_DateTool.format()</code>.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("desc").maxResults(15))

#queryfilter($query, $asset)
  $_PropertyTool.isNotEmpty($asset.getStructuredDataNode("event-date").textValue)
#end

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  ${date.getTime()}
#end

#queryexecute($query, $event)
  #set ($dt = $event.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  #set ($formatted = $_DateTool.format("MMMM d, yyyy", $date))
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;$formatted&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="accordion">
  <button class="accordion__trigger" aria-expanded="false" aria-controls="live-acc-9">
    <span class="accordion__title">Count pages per category using a map</span>
    <svg class="accordion__chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="accordion__panel" id="live-acc-9" role="region" hidden>
    <div class="accordion__content">
<p>Define a map of categories with initial counts of zero. Iterate all pages, check each category, and increment the count. Output the breakdown with <code>#foreach</code> on the map entries.</p>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").maxResults(-1))
#set ($cats = {"Technology": 0, "Science": 0, "Education": 0, "Healthcare": 0, "Business": 0})

#queryexecute($query, $page)
  #set ($t = $page.metadata.title)
  #foreach($cat in $cats.keySet())
    #if($t.contains($cat))
      #set ($n = $cats.get($cat) + 1)
      #set ($dummy = $cats.put($cat, $n))
    #end
  #end
#end

&lt;ul&gt;
#foreach($entry in $cats.entrySet())
  &lt;li&gt;$entry.key: $entry.value&lt;/li&gt;
#end
&lt;/ul&gt;</code></pre>
</div>
    </div>
  </div>
</div>

<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-8">Migration guide</h2>
                        <p>Converting an existing <code>.execute()</code> pattern to use directives is straightforward.</p>
<h3>Before: .execute() + #foreach</h3>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($results = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc").execute())

#foreach ($page in $results)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<h3>After: #queryexecute</h3>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc"))

#queryexecute($query, $page)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<p>Key changes:</p>
<ol>
<li>Remove <code>.execute()</code> from the query chain.</li>
<li>Replace <code>#foreach ($page in $results)</code> with <code>#queryexecute($query, $page)</code>.</li>
<li>The body stays the same.</li>
</ol>
<h3>Before: .execute() with manual filtering</h3>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($list = $_.query().byContentType("News").preloadStructuredData().execute())

#foreach ($page in $list)
  #if ($page.getStructuredDataNode("details/is-featured").textValue.contains("Yes"))
    &lt;div&gt;$page.metadata.title&lt;/div&gt;
  #end
#end</code></pre>
</div>
<h3>After: #queryfilter + #queryexecute</h3>
<div class="code-block">
  <div class="code-block__header">
    <span class="code-block__language">Velocity</span>
    <button class="code-block__copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="code-block__pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").preloadStructuredData())

#queryfilter($query, $asset)
  $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;div&gt;$page.metadata.title&lt;/div&gt;
#end</code></pre>
</div>
<p>Key changes:</p>
<ol>
<li>Remove <code>.execute()</code> and the <code>#foreach</code>/<code>#if</code> block.</li>
<li>Move the condition into <code>#queryfilter</code>. The body must return the exact string <code>true</code>.</li>
<li>Use <code>#queryexecute</code> for the output, now with only matching results.</li>
</ol>
<div class="callout callout--tip">
  <div class="callout__content">
    <p class="callout__title">Tip</p>
    <p>With <code>#queryfilter</code>, the filtering happens <em>before</em> <code>maxResults()</code> is applied. This means you get the correct number of matching results, rather than filtering down from a potentially truncated list.</p>
  </div>
</div>
        </div>
        <footer class="content__footer">
  <div class="content__meta">
    <span>Last updated: February 22, 2026</span>
  </div>
  <nav class="content__pagination">
    <a href="../date-tool-essentials/" class="content__prev"><span>Previous</span><span>Date Tool Essentials</span></a>
    <a href="../velocity-best-practices/" class="content__next"><span>Next</span><span>Best practices for performance</span></a>
  </nav>
</footer>
      </article>
    </main>

    <aside class="toc" aria-label="Table of contents">
      <div class="toc__sticky">
        <h2 class="toc__title">ON THIS PAGE</h2>
        <nav class="toc__nav"></nav>
      </div>
    </aside>

    <button class="toc-toggle" aria-label="Table of contents" aria-expanded="false">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
    </button>
  </div>

  <footer class="site-footer" role="contentinfo">
  <div class="site-footer__inner">
    <nav class="site-footer__primary" aria-label="Footer primary links">
      <a class="site-footer__primary-link" href="https://www.hannonhill.com/cascadecms/latest/">Documentation Home</a>
      <a class="site-footer__primary-link" href="https://www.hannonhill.com/cascadecms/latest/release-notes/index.html">Release Notes</a>
      <a class="site-footer__primary-link" href="https://support.hannonhill.com/">Support</a>
      <a class="site-footer__primary-link" href="https://www.hannonhill.com/cascadecms/latest/rss/index.html">RSS</a>
    </nav>
    <div class="site-footer__bottom">
      <p class="site-footer__copyright">All content &copy; 2026 Hannon Hill. All rights reserved.</p>
      <nav class="site-footer__links" aria-label="Footer links">
        <a class="site-footer__link" href="https://www.hannonhill.com/about-us">About Us</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/careers">Careers</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/compliance">Compliance</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/resources">Resources</a>
        <a class="site-footer__link" href="https://hannonhill.ideas.aha.io/">Idea Portal</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/site-index">Site Index</a>
        <a class="site-footer__link" href="https://github.com/hannonhill">Github</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/accessibility-policy">Accessibility</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/privacy-policy">Privacy Policy</a>
        <a class="site-footer__link" href="https://www.hannonhill.com/legal">Legal</a>
      </nav>
    </div>
  </div>
</footer>
  <div class="search-overlay" role="dialog" aria-modal="true" aria-label="Search documentation" data-search-index="../../../search-index.json" hidden>
    <div class="search-overlay__backdrop"></div>
    <div class="search-overlay__dialog">
      <div class="search-overlay__header">
        <svg class="search-overlay__icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="search" class="search-overlay__input" placeholder="Search documentation..." autocomplete="off">
        <kbd class="search-overlay__shortcut">ESC</kbd>
      </div>
      <div class="search-overlay__live" role="status" aria-live="polite" aria-atomic="true" style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;"></div>
      <div class="search-overlay__results"><div class="search-overlay__empty">Start typing to search...</div></div>
      <div class="search-overlay__footer"><span>Navigate with <kbd>&uarr;</kbd><kbd>&darr;</kbd></span><span>Open with <kbd>&crarr;</kbd></span></div>
    </div>
  </div>

  <script src="../../../../_assets/vendor/prism/prism.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-markup.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-css.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-javascript.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-java.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-python.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-json.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-bash.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-yaml.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-sql.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-markup-templating.min.js" defer></script>
  <script src="../../../../_assets/vendor/prism/prism-velocity.min.js" defer></script>
  <script src="../../../../_assets/vendor/lunr/lunr.min.js" defer></script>
  <script src="../../../../_assets/js/theme.js" defer></script>
  <script src="../../../../_assets/js/sidebar.js" defer></script>
  <script src="../../../../_assets/js/toc.js" defer></script>
  <script src="../../../../_assets/js/tabs.js" defer></script>
  <script src="../../../../_assets/js/accordion.js" defer></script>
  <script src="../../../../_assets/js/code-block.js" defer></script>
  <script src="../../../../_assets/js/search.js" defer></script>
</body>
</html>