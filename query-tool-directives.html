<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Query Tool Directives - Cascade CMS Knowledge Base</title>
  <meta name="description" content="Introduced in Cascade CMS 8.26, Query Directives are an alternative to the .execute() method on the Query API. They process results one asset at a time instead of loading">
  <script>
  (function () {
    var pref = localStorage.getItem('theme-preference');
    var theme;
    if (pref === 'dark') { theme = 'dark'; }
    else if (pref === 'light') { theme = 'light'; }
    else { theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'; }
    document.documentElement.setAttribute('data-theme', theme);
  })();
  </script>
  <link rel="stylesheet" href="./_assets/css/bundle.min.css">
  <link rel="stylesheet" href="./_assets/css/print.css" media="print">
</head>
<body id="top">
  <a href="#main-content" class="hh-skip-link">Skip to main content</a>
  <header class="hh-header" role="banner">
    <div class="hh-header-left">
      <button class="hh-header-menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
      <a href="./" class="hh-header-logo"><span style="color: var(--color-primary-vivid); font-weight: 700;">Cascade</span>&nbsp;CMS Docs</a>
    </div>
    <nav class="hh-header-nav" aria-label="Top navigation">
      <a href="#" class="hh-header-nav-link hh-header-nav-link-active">Knowledge Base</a>
      <a href="#" class="hh-header-nav-link">Release Notes</a>
      <a href="#" class="hh-header-nav-link">Support</a>
    </nav>
    <div class="hh-header-right">
      <button class="hh-header-search-trigger" aria-label="Search documentation">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <span class="hh-header-search-text">Search...</span>
        <kbd class="hh-header-search-kbd">⌘K</kbd>
      </button>
      <div class="hh-theme-toggle">
        <button class="hh-theme-toggle-button" aria-label="Toggle color theme" aria-expanded="false" aria-haspopup="true">
          <svg class="hh-theme-toggle-icon hh-theme-toggle-icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
          <svg class="hh-theme-toggle-icon hh-theme-toggle-icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
          <svg class="hh-theme-toggle-icon hh-theme-toggle-icon-system" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
        </button>
        <div class="hh-theme-toggle-dropdown" role="menu" hidden>
          <button class="hh-theme-toggle-option" role="menuitem" data-theme="light">Light</button>
          <button class="hh-theme-toggle-option" role="menuitem" data-theme="dark">Dark</button>
          <button class="hh-theme-toggle-option hh-theme-toggle-option-active" role="menuitem" data-theme="system">System</button>
        </div>
      </div>
    </div>
  </header>

  <div class="hh-sidebar-overlay"></div>
  <div class="hh-docs-layout">
    <aside class="hh-sidebar" aria-label="Documentation navigation">
      <nav class="hh-sidebar-nav">
        <div class="hh-sidebar-section">
  <button class="hh-sidebar-category" aria-expanded="true">
    Script Formats
    <svg class="hh-sidebar-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <ul class="hh-sidebar-pages">
    <li><a href="./velocity-tools.html" class="hh-sidebar-link">Velocity Tools</a></li>
    <li><a href="./date-tool-essentials.html" class="hh-sidebar-link">Date Tool Essentials</a></li>
    <li><a href="./query-tool-directives.html" class="hh-sidebar-link hh-sidebar-link-active" aria-current="page">Query Tool Directives</a></li>
    <li><a href="./velocity-best-practices.html" class="hh-sidebar-link">Best Practices for Performance</a></li>
  </ul>
</div>
      </nav>
    </aside>

    <main id="main-content" class="hh-main">
      <article class="hh-content">
        <nav class="hh-breadcrumb" aria-label="Breadcrumb">
  <ol class="hh-breadcrumb-list">
    <li class="hh-breadcrumb-item"><a href="./" class="hh-breadcrumb-link">Home</a></li>
    <li class="hh-breadcrumb-item hh-breadcrumb-item-current" aria-current="page">Query Tool Directives</li>
  </ol>
</nav>
        <header class="hh-content-header">
          <span class="hh-content-category-label">Developing In Cascade</span>
          <h1 class="hh-content-title">Query Tool Directives</h1>
        </header>
        <div class="hh-content-body">
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-1">Overview</h2>
                        <p>Introduced in Cascade CMS 8.26, Query Directives are an alternative to the <code>.execute()</code> method on the Query API. They process results one asset at a time instead of loading everything into a list, which means they can handle up to <strong>100,000</strong> results (compared to the 2,000 limit with <code>.execute()</code>).</p>
<p>There are three directives:</p>
<ul>
<li><code>#queryexecute</code> – iterate over results and output content for each asset</li>
<li><code>#queryfilter</code> – apply custom filtering logic before <code>maxResults()</code> is applied</li>
<li><code>#querysortvalue</code> – define a custom sort value before <code>maxResults()</code> is applied</li>
</ul>
<p>All three use the same basic pattern: pass a query object and an asset variable, write your logic in the body, and close with <code>#end</code>.</p>
<div class="hh-callout hh-callout-tip">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Tip</p>
    <p>Use <code>$enabledCustomDirectives</code> to check which custom directives are available in your CMS environment.</p>
  </div>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-2">When to use directives</h2>
                        <div class="table-wrapper">
  <table class="hh-table hh-table-striped"><caption>Quick decision guide: .execute() vs directives</caption>
<thead>
<tr>
<th scope="col">Scenario</th>
<th scope="col">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Results under 2,000 with no custom filtering or sorting</td>
<td><code>.execute()</code></td>
</tr>
<tr>
<td>Need more than 2,000 results</td>
<td><code>#queryexecute</code></td>
</tr>
<tr>
<td>Need to filter on values not available via built-in query methods</td>
<td><code>#queryfilter</code></td>
</tr>
<tr>
<td>Need to sort by structured data, dynamic metadata, or computed values</td>
<td><code>#querysortvalue</code></td>
</tr>
<tr>
<td>Under 2,000 results but need custom filtering or sorting</td>
<td><code>#queryfilter</code> / <code>#querysortvalue</code> + <code>.execute()</code></td>
</tr>
<tr>
<td>Large dataset with custom filter + sort + output</td>
<td>All three combined</td>
</tr>
</tbody>
</table>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-3">#queryexecute</h2>
                        <p>Replaces the <code>.execute()</code> + <code>#foreach</code> pattern. The directive iterates over results directly, processing one asset at a time. Supports <code>maxResults()</code> up to <strong>100,000</strong>.</p>
<div class="table-wrapper">
  <table class="hh-table hh-table-striped"><caption>Available arguments for #queryexecute.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute and output for each asset.</td>
</tr>
</tbody>
</table>
</div>
<div class="hh-callout hh-callout-warning">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Important</p>
    <p>Unlike <code>#foreach</code>, this directive clears the previous asset from memory on each iteration. This means <code>$foreach.count</code>, <code>$foreach.hasNext</code>, <code>$foreach.index</code>, and other loop variables are <strong>not available</strong>. If you need a counter or first-iteration check, manage it yourself with a <code>#set</code> variable.</p>
  </div>
</div>
<h3>Basic usage</h3>
<p>Build a query, then pass it to <code>#queryexecute</code> instead of calling <code>.execute()</code>.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">## Build the query (do NOT call .execute())
#set ($query = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc"))

## Iterate with the directive
#queryexecute($query, $page)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<h3>Sitemap generation</h3>
<p>Query directives are well suited for sitemaps where the result set can be very large.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Default-Page").indexableOnly(true).preloadDynamicMetadata())
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt;
  #queryexecute($query, $page)
    &lt;url&gt;
      &lt;loc&gt;https://yoursite.com${page.path}.html&lt;/loc&gt;
    &lt;/url&gt;
  #end
&lt;/urlset&gt;</code></pre>
</div>
<h3>Large datasets with preloaded data</h3>
<p>When working with structured data across many results, preload it on the query to avoid per-asset database round trips.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().maxResults(5000).sortBy("startDate").sortDirection("asc"))

#queryexecute($query, $event)
  #set ($start = $event.getStructuredDataNode("startDateTime").textValue)
  #set ($title = $event.metadata.title)
  &lt;div class="event-card"&gt;
    &lt;h3&gt;$title&lt;/h3&gt;
    &lt;span&gt;$start&lt;/span&gt;
  &lt;/div&gt;
#end</code></pre>
</div>
<h3>Cross-site query</h3>
<p>Query across all sites for assets using a shared Content Type.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("site://Global/Shared Page").searchAcrossAllSites().preloadDynamicMetadata().maxResults(10000))

#queryexecute($query, $page)
  &lt;li&gt;
    &lt;a href="${page.link}"&gt;${page.metadata.title}&lt;/a&gt;
    &lt;small&gt;(${page.siteName})&lt;/small&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
<h3>JSON feed</h3>
<p>Since loop variables aren't available, use a flag variable like <code>$isFirstIteration</code> for comma separation in JSON output.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set($query = $_.query().byContentType("Event").preloadStructuredData().sortBy("startDate"))
#set($isFirstIteration = true)

[
#queryexecute($query, $event)
    #if(!$isFirstIteration),#end
    #set($title = $_EscapeTool.java($event.metadata.title.trim()))
    #set($date  = $event.getStructuredDataNode("event-date").textValue)
    {
        "title": "${title}",
        "date":  "${date}",
        "url":   ""
    }
    #set($isFirstIteration = false)
#end
]</code></pre>
</div>
<p>The key pattern: <code>#if(!$isFirstIteration),#end</code> outputs a comma before every entry except the first, replacing what you'd normally do with <code>$foreach.hasNext</code>.</p>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-4">#queryfilter</h2>
                        <p>Executes body logic on each asset matching a query <em>before</em> <code>maxResults()</code> is applied. If the body logic returns <code>true</code>, the asset is included in the results.</p>
<div class="table-wrapper">
  <table class="hh-table hh-table-striped"><caption>Available arguments for #queryfilter.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute. Must return the exact string <code>true</code> to include the asset.</td>
</tr>
</tbody>
</table>
</div>
<div class="hh-callout hh-callout-warning">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Note</p>
    <p>Built-in filtering methods result in faster performance and this directive should only be used for scenarios where there is no built-in method. For example, <code>.bySiteName</code> will be faster than using <code>#queryfilter</code> with Site name comparison logic.</p>
  </div>
</div>
<div class="hh-callout hh-callout-tip">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Tip</p>
    <p>You can move your logic into <code>#queryexecute</code> temporarily to test the functionality and ensure that your body logic returns the exact string <code>true</code>.</p>
  </div>
</div>
<div class="hh-callout hh-callout-tip">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Tip</p>
    <p>The preferred way to return a value from the filter body is to use <code>#set</code> to capture the result, then output it:
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = $asset.path.contains("index"))
  $result
#end</code></pre>
</div>
This pattern handles negation and multiple conditions cleanly without needing <code>#if</code>/<code>true</code>/<code>#end</code>.</p>
  </div>
</div>
<h3>Filter by path pattern</h3>
<p>Only include index pages from the query results.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  $asset.path.contains("index")
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Filter by structured data value</h3>
<p>Include only assets where a structured data checkbox has a specific value. This is useful for multi-value fields where built-in methods can't filter directly.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").preloadStructuredData())

#queryfilter($query, $asset)
  $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;div class="featured-news"&gt;
    &lt;h3&gt;${page.metadata.title}&lt;/h3&gt;
    &lt;p&gt;${page.metadata.summary}&lt;/p&gt;
  &lt;/div&gt;
#end</code></pre>
</div>
<h3>Filter by dynamic metadata</h3>
<p>Include only assets where a dynamic metadata field matches a condition.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Page").preloadDynamicMetadata())

#queryfilter($query, $asset)
  $asset.metadata.getDynamicField("display-in-nav").value.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;li&gt;&lt;a href="${page.link}"&gt;${page.metadata.displayName}&lt;/a&gt;&lt;/li&gt;
#end</code></pre>
</div>
<h3>Filter by empty or populated field</h3>
<p>Use <code>$_PropertyTool.isNotEmpty()</code> to include only assets where a field has a value. Negate it to find assets where a field is empty.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">## Only pages where the author field is populated
#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  $_PropertyTool.isNotEmpty($asset.metadata.author)
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title} &amp;mdash; ${page.metadata.author}&lt;/li&gt;
#end</code></pre>
</div>
<p>To find assets where a field is <em>empty</em>, negate the check with <code>#set</code>:</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = !$_PropertyTool.isNotEmpty($asset.metadata.author))
  $result
#end</code></pre>
</div>
<h3>Multiple conditions</h3>
<p>Use <code>#set</code> to combine conditions with <code>&amp;&amp;</code> or <code>||</code>. The result is captured as a boolean and output directly.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData())

#queryfilter($query, $asset)
  #set($result = $asset.path.contains("index") &amp;&amp; $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<p>OR logic works the same way:</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#queryfilter($query, $asset)
  #set($result = $asset.metadata.title.contains("News") || $asset.metadata.title.contains("Events"))
  $result
#end</code></pre>
</div>
<h3>Exclude pattern</h3>
<p>To exclude assets matching a condition, negate the check.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#queryfilter($query, $asset)
  #set($result = !$asset.path.contains("/archive/"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-5">#querysortvalue</h2>
                        <p>Executes body logic on each asset to determine the sort value <em>before</em> <code>maxResults()</code> is applied. This is an alternative to <code>.sortBy()</code> and can be used with both <code>#queryexecute</code> and <code>.execute()</code>.</p>
<div class="table-wrapper">
  <table class="hh-table hh-table-striped"><caption>Available arguments for #querysortvalue.</caption>
<thead>
<tr>
<th scope="col">Argument</th>
<th scope="col">Type</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>SearchQuery<br>required</td>
<td>A query object.</td>
</tr>
<tr>
<td>asset</td>
<td>Object<br>required</td>
<td>Populated automatically by the system. Points to a new asset on each iteration, while the old asset gets cleared to save memory.</td>
</tr>
<tr>
<td><em>body</em></td>
<td>Logic<br>required</td>
<td>Logic to execute. The return value is used as the sort key.</td>
</tr>
</tbody>
</table>
</div>
<div class="hh-callout hh-callout-warning">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Note</p>
    <p>Built-in sorting methods result in faster performance. For example, <code>.sortBy("name")</code> will be faster than using <code>#querysortvalue</code> with <code>$asset.name</code> as the logic.</p>
  </div>
</div>
<div class="hh-callout hh-callout-tip">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Tips</p>
    <p><ul>
<li>This directive sorts by <strong>string</strong> only. When sorting numbers, use <code>$_NumberTool.withPadding</code> to ensure results sort correctly.</li>
<li>This directive respects the value passed into <code>.sortDirection()</code> on the query.</li>
</ul></p>
  </div>
</div>
<h3>Sort by metadata title</h3>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article"))

#querysortvalue($query, $asset)
  $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Sort by structured data text field</h3>
<p>Sort by a text value stored in structured data rather than a metadata field.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("title").textValue
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.getStructuredDataNode("title").textValue}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Numeric sorting with $_NumberTool.withPadding</h3>
<p>Since <code>#querysortvalue</code> sorts by string, numeric values need padding to sort correctly (e.g., "5" would sort after "10" without padding).</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Course").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $_NumberTool.withPadding($asset.getStructuredDataNode("course-number").textValue)
#end

#queryexecute($query, $course)
  &lt;li&gt;${course.getStructuredDataNode("course-number").textValue} - ${course.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Multi-level sorting</h3>
<p>Since sorting is string-based, you can concatenate multiple values to sort by more than one field. The first value acts as the primary sort, the second as the tiebreaker, and so on.</p>
<h4>Alphabetical by last name, then first name</h4>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Staff").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("last-name").textValue $asset.getStructuredDataNode("first-name").textValue
#end

#queryexecute($query, $person)
  &lt;li&gt;${person.getStructuredDataNode("last-name").textValue}, ${person.getStructuredDataNode("first-name").textValue}&lt;/li&gt;
#end</code></pre>
</div>
<h4>By department number, then course name</h4>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Course").preloadStructuredData().sortDirection("asc"))

#querysortvalue($query, $asset)
  $_NumberTool.withPadding($asset.getStructuredDataNode("department-number").textValue) $asset.metadata.title
#end

#queryexecute($query, $course)
  &lt;li&gt;${course.getStructuredDataNode("department-number").textValue} - ${course.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<p>Note the <code>$_NumberTool.withPadding</code> on the department number. Without it, department "5" would sort after "10" since it's comparing strings.</p>
<h4>By author, then title</h4>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").sortDirection("asc").maxResults(50))

#querysortvalue($query, $asset)
  $asset.metadata.author $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.author} &amp;mdash; ${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
<h3>Sort by date stored in structured data</h3>
<p>Date strings like <code>01-15-2024 02:30:00 PM</code> won't sort chronologically as plain strings because the month comes first. Convert the value to epoch milliseconds with <code>$_DateTool</code> so the sort is truly chronological.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("desc").maxResults(20))

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

#queryexecute($query, $event)
  &lt;li&gt;
    ${event.metadata.title}
    &lt;span&gt;${event.getStructuredDataNode("event-date").textValue}&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
<p>The format string passed to <code>$_DateTool.toDate()</code> must match the format stored in your data definition. Adjust it to match your field's format.</p>
<h3>Sort descending</h3>
<p>The directive respects <code>.sortDirection()</code>. Set it on the query object before using <code>#querysortvalue</code>.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").sortDirection("desc"))

#querysortvalue($query, $asset)
  $asset.metadata.title
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
                                    
<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-6">Combining directives</h2>
                        
<p>All three directives can be used together on the same query. The order of operations is: <code>#queryfilter</code> runs first to narrow the results, then <code>#querysortvalue</code> determines the sort order, and finally <code>#queryexecute</code> outputs the results up to the <code>maxResults()</code> limit.</p>
<h3>Full example: filtered, sorted event listing</h3>
<p>Query all events, filter to only featured ones, sort by a structured data date field, and output the first 50.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">## Build the query
#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("asc").maxResults(50))

## Filter: only featured events
#queryfilter($query, $asset)
  $asset.getStructuredDataNode("is-featured").textValue.contains("Yes")
#end

## Sort: by event date stored in structured data
#querysortvalue($query, $asset)
  $asset.getStructuredDataNode("event-date").textValue
#end

## Output
&lt;ul&gt;
#queryexecute($query, $event)
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;${event.getStructuredDataNode("event-date").textValue}&lt;/span&gt;
  &lt;/li&gt;
#end
&lt;/ul&gt;</code></pre>
</div>
<h3>Date range filter with chronological sorting</h3>
<p>Filter to events within a specific date range and sort them chronologically. The filter parses each date into epoch milliseconds for comparison, and the sort does the same for ordering.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("asc").maxResults(100))
#set ($rangeStart = $_DateTool.toDate("yyyy-MM-dd", "2024-01-01").getTime())
#set ($rangeEnd = $_DateTool.toDate("yyyy-MM-dd", "2024-12-31").getTime())

## Filter: only events in 2024
#queryfilter($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($ts = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt).getTime())
    #if($ts &gt;= $rangeStart &amp;&amp; $ts &lt;= $rangeEnd)
      true
    #end
  #end
#end

## Sort: chronological by event date
#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

## Output with formatted date
#queryexecute($query, $event)
  #set ($dt = $event.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  #set ($formatted = $_DateTool.format("MMMM d, yyyy", $date))
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;$formatted&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>

<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-7">In-depth examples</h2>
                        
<p>These examples demonstrate advanced patterns that build on the basics above. They reference a Content Type with the following fields. Adapt the content type path and field names to match your own setup.</p>
<ul>
<li><strong>Structured data</strong>: <code>title</code> (text), <code>event-date</code> (datetime in <code>MM-dd-yyyy hh:mm:ss a</code> format), <code>asset-chooser</code> (page chooser)</li>
<li><strong>Dynamic metadata</strong>: <code>multiselect</code> (multi-select), <code>checkbox</code> (checkbox), <code>department</code> (dropdown), <code>radio</code> (radio), <code>noindex</code> (radio)</li>
<li><strong>Standard metadata</strong>: title, author, displayName, summary, description, teaser, keywords, startDate, endDate</li>
</ul>
<h3>Filtering</h3>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-1">
    <span class="hh-accordion-title">Filter by all values in a multi-select field</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-1" role="region" hidden>
    <div class="hh-accordion-content">
<p>Check that a multi-value field contains every expected value using multiple <code>.contains()</code> calls joined with <code>&amp;&amp;</code>.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().maxResults(-1))

#queryfilter($query, $asset)
  #set ($cb = $asset.metadata.getDynamicField("checkbox").value)
  #set($result = $cb.contains("Easy") &amp;&amp; $cb.contains("Fast") &amp;&amp; $cb.contains("Cheap"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-2">
    <span class="hh-accordion-title">Combine structured data, dynamic metadata, and standard metadata</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-2" role="region" hidden>
    <div class="hh-accordion-content">
<p>Filter using fields from three different sources in one condition. Preload both structured data and dynamic metadata on the query.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().preloadDynamicMetadata().maxResults(-1))

#queryfilter($query, $asset)
  #set($result = $_PropertyTool.isNotEmpty($asset.getStructuredDataNode("event-date").textValue) &amp;&amp; $asset.metadata.getDynamicField("checkbox").value.contains("Easy") &amp;&amp; $asset.getStructuredDataNode("title").textValue.contains("Guide"))
  $result
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.getStructuredDataNode("title").textValue}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Sorting</h3>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-3">
    <span class="hh-accordion-title">Sort by field value, then by date chronologically</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-3" role="region" hidden>
    <div class="hh-accordion-content">
<p>Concatenate a text field with epoch milliseconds for a two-level sort. The text field acts as the primary sort, and the date as the tiebreaker.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().preloadDynamicMetadata().sortDirection("asc").maxResults(30))

#querysortvalue($query, $asset)
  #set ($group = $asset.metadata.getDynamicField("department").value)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${group} ${date.getTime()}
  #else
    ${group} 0
  #end
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.getDynamicField("department").value} &amp;mdash; ${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Combined</h3>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-4">
    <span class="hh-accordion-title">Most recent pages in a filtered category</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-4" role="region" hidden>
    <div class="hh-accordion-content">
<p>Combine <code>#queryfilter</code> to narrow by category, <code>#querysortvalue</code> to sort by date descending, and <code>maxResults(10)</code> to take only the top 10.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().sortDirection("desc").maxResults(10))

#queryfilter($query, $asset)
  $asset.metadata.title.contains("Science")
#end

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #if($_PropertyTool.isNotEmpty($dt))
    #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
    ${date.getTime()}
  #else
    0
  #end
#end

#queryexecute($query, $page)
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-5">
    <span class="hh-accordion-title">Three-field filter with two-field sort</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-5" role="region" hidden>
    <div class="hh-accordion-content">
<p>Filter on three conditions (dynamic metadata + standard metadata), then sort by two concatenated fields.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadStructuredData().preloadDynamicMetadata().sortDirection("asc").maxResults(25))

#queryfilter($query, $asset)
  #set($result = $asset.metadata.getDynamicField("checkbox").value.contains("Fast") &amp;&amp; $asset.metadata.getDynamicField("noindex").value.contains("No") &amp;&amp; $_PropertyTool.isNotEmpty($asset.metadata.summary))
  $result
#end

#querysortvalue($query, $asset)
  $asset.metadata.getDynamicField("department").value $asset.metadata.author
#end

#queryexecute($query, $page)
  &lt;li&gt;
    ${page.metadata.getDynamicField("department").value} &amp;mdash;
    ${page.metadata.author} &amp;mdash;
    ${page.metadata.title}
  &lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-6">
    <span class="hh-accordion-title">Group results under dynamic headers</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-6" role="region" hidden>
    <div class="hh-accordion-content">
<p>Sort by the grouping field so identical values are adjacent, then detect when the value changes to insert a header.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().sortDirection("asc").maxResults(50))

#querysortvalue($query, $asset)
  $asset.metadata.getDynamicField("department").value $asset.metadata.title
#end

#set ($currentGroup = "")
#queryexecute($query, $page)
  #set ($group = $page.metadata.getDynamicField("department").value)
  #if($group != $currentGroup)
    &lt;h3&gt;$group&lt;/h3&gt;
    #set ($currentGroup = $group)
  #end
  &lt;li&gt;${page.metadata.title}&lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<h3>Advanced patterns</h3>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-7">
    <span class="hh-accordion-title">Aggregate counts by field value</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-7" role="region" hidden>
    <div class="hh-accordion-content">
<p>Use a map to count how many pages have each value in a field. Arithmetic (<code>+</code>) only works inside <code>#set</code> directives, not inside method arguments like <code>.put()</code>.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").preloadDynamicMetadata().maxResults(-1))
#set ($counts = {"Yes": 0, "No": 0, "Maybe": 0})

#queryexecute($query, $page)
  #set ($val = $page.metadata.getDynamicField("radio").value)
  #if($val.contains("Yes"))
    #set ($n = $counts.get("Yes") + 1)
    #set ($dummy = $counts.put("Yes", $n))
  #elseif($val.contains("No"))
    #set ($n = $counts.get("No") + 1)
    #set ($dummy = $counts.put("No", $n))
  #elseif($val.contains("Maybe"))
    #set ($n = $counts.get("Maybe") + 1)
    #set ($dummy = $counts.put("Maybe", $n))
  #end
#end
Yes: $counts.get("Yes"), No: $counts.get("No"), Maybe: $counts.get("Maybe")</code></pre>
</div>
    </div>
  </div>
</div>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-8">
    <span class="hh-accordion-title">Parse, sort, and format dates for display</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-8" role="region" hidden>
    <div class="hh-accordion-content">
<p>Filter to pages with a date, sort chronologically using epoch milliseconds, then format the date for readable output with <code>$_DateTool.format()</code>.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Event").preloadStructuredData().sortDirection("desc").maxResults(15))

#queryfilter($query, $asset)
  $_PropertyTool.isNotEmpty($asset.getStructuredDataNode("event-date").textValue)
#end

#querysortvalue($query, $asset)
  #set ($dt = $asset.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  ${date.getTime()}
#end

#queryexecute($query, $event)
  #set ($dt = $event.getStructuredDataNode("event-date").textValue)
  #set ($date = $_DateTool.toDate("MM-dd-yyyy hh:mm:ss a", $dt))
  #set ($formatted = $_DateTool.format("MMMM d, yyyy", $date))
  &lt;li&gt;
    &lt;strong&gt;${event.metadata.title}&lt;/strong&gt;
    &lt;span&gt;$formatted&lt;/span&gt;
  &lt;/li&gt;
#end</code></pre>
</div>
    </div>
  </div>
</div>
<div class="hh-accordion">
  <button class="hh-accordion-trigger" aria-expanded="false" aria-controls="live-acc-9">
    <span class="hh-accordion-title">Count pages per category using a map</span>
    <svg class="hh-accordion-chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  <div class="hh-accordion-panel" id="live-acc-9" role="region" hidden>
    <div class="hh-accordion-content">
<p>Define a map of categories with initial counts of zero. Iterate all pages, check each category, and increment the count. Output the breakdown with <code>#foreach</code> on the map entries.</p>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").maxResults(-1))
#set ($cats = {"Technology": 0, "Science": 0, "Education": 0, "Healthcare": 0, "Business": 0})

#queryexecute($query, $page)
  #set ($t = $page.metadata.title)
  #foreach($cat in $cats.keySet())
    #if($t.contains($cat))
      #set ($n = $cats.get($cat) + 1)
      #set ($dummy = $cats.put($cat, $n))
    #end
  #end
#end

&lt;ul&gt;
#foreach($entry in $cats.entrySet())
  &lt;li&gt;$entry.key: $entry.value&lt;/li&gt;
#end
&lt;/ul&gt;</code></pre>
</div>
    </div>
  </div>
</div>

<h2 id="developing-in-cascade-script-formats-query-tool-directives-section-8">Migration guide</h2>
                        <p>Converting an existing <code>.execute()</code> pattern to use directives is straightforward.</p>
<h3>Before: .execute() + #foreach</h3>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($results = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc").execute())

#foreach ($page in $results)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<h3>After: #queryexecute</h3>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("Article").maxResults(10).sortBy("startDate").sortDirection("desc"))

#queryexecute($query, $page)
  &lt;h3&gt;$page.metadata.title&lt;/h3&gt;
  &lt;p&gt;$page.metadata.summary&lt;/p&gt;
#end</code></pre>
</div>
<p>Key changes:</p>
<ol>
<li>Remove <code>.execute()</code> from the query chain.</li>
<li>Replace <code>#foreach ($page in $results)</code> with <code>#queryexecute($query, $page)</code>.</li>
<li>The body stays the same.</li>
</ol>
<h3>Before: .execute() with manual filtering</h3>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($list = $_.query().byContentType("News").preloadStructuredData().execute())

#foreach ($page in $list)
  #if ($page.getStructuredDataNode("details/is-featured").textValue.contains("Yes"))
    &lt;div&gt;$page.metadata.title&lt;/div&gt;
  #end
#end</code></pre>
</div>
<h3>After: #queryfilter + #queryexecute</h3>
<div class="hh-code-block">
  <div class="hh-code-block-header">
    <span class="hh-code-block-language">Velocity</span>
    <button class="hh-code-block-copy" aria-label="Copy code">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>
      <span>Copy</span>
    </button>
  </div>
  <pre class="hh-code-block-pre"><code class="language-velocity">#set ($query = $_.query().byContentType("News").preloadStructuredData())

#queryfilter($query, $asset)
  $asset.getStructuredDataNode("details/is-featured").textValue.contains("Yes")
#end

#queryexecute($query, $page)
  &lt;div&gt;$page.metadata.title&lt;/div&gt;
#end</code></pre>
</div>
<p>Key changes:</p>
<ol>
<li>Remove <code>.execute()</code> and the <code>#foreach</code>/<code>#if</code> block.</li>
<li>Move the condition into <code>#queryfilter</code>. The body must return the exact string <code>true</code>.</li>
<li>Use <code>#queryexecute</code> for the output, now with only matching results.</li>
</ol>
<div class="hh-callout hh-callout-tip">
  <div class="hh-callout-content">
    <p class="hh-callout-title">Tip</p>
    <p>With <code>#queryfilter</code>, the filtering happens <em>before</em> <code>maxResults()</code> is applied. This means you get the correct number of matching results, rather than filtering down from a potentially truncated list.</p>
  </div>
</div>
        </div>
        <footer class="hh-content-footer">
  <div class="hh-content-meta">
    <span>Last updated: February 22, 2026</span>
  </div>
  <nav class="hh-content-pagination" aria-label="Article navigation">
    <a href="./date-tool-essentials.html" class="hh-content-prev"><span>Previous</span><span>Date Tool Essentials</span></a>
    <a href="./velocity-best-practices.html" class="hh-content-next"><span>Next</span><span>Best Practices for Performance</span></a>
  </nav>
</footer>
      </article>
    </main>

    <aside class="hh-toc" aria-label="Table of contents">
      <div class="hh-toc-sticky">
        <h2 class="hh-toc-title">ON THIS PAGE</h2>
        <nav class="hh-toc-nav"></nav>
      </div>
    </aside>

    <button class="hh-toc-toggle" aria-label="Table of contents" aria-expanded="false">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
    </button>
  </div>

  <footer class="hh-site-footer" role="contentinfo">
  <div class="hh-site-footer-inner">
    <nav class="hh-site-footer-primary" aria-label="Footer primary links">
      <a class="hh-site-footer-primary-link" href="https://www.hannonhill.com/cascadecms/latest/">Documentation Home</a>
      <a class="hh-site-footer-primary-link" href="https://www.hannonhill.com/cascadecms/latest/release-notes/index.html">Release Notes</a>
      <a class="hh-site-footer-primary-link" href="https://support.hannonhill.com/">Support</a>
      <a class="hh-site-footer-primary-link" href="https://www.hannonhill.com/cascadecms/latest/rss/index.html">RSS</a>
    </nav>
    <div class="hh-site-footer-bottom">
      <p class="hh-site-footer-copyright">All content &copy; 2026 Hannon Hill. All rights reserved.</p>
      <nav class="hh-site-footer-links" aria-label="Footer links">
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/about-us">About Us</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/careers">Careers</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/compliance">Compliance</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/resources">Resources</a>
        <a class="hh-site-footer-link" href="https://hannonhill.ideas.aha.io/">Idea Portal</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/site-index">Site Index</a>
        <a class="hh-site-footer-link" href="https://github.com/hannonhill">Github</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/accessibility-policy">Accessibility</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/privacy-policy">Privacy Policy</a>
        <a class="hh-site-footer-link" href="https://www.hannonhill.com/legal">Legal</a>
      </nav>
    </div>
  </div>
</footer>
  <div class="hh-search-overlay" role="dialog" aria-modal="true" aria-label="Search documentation" data-search-index="./search-index.json" hidden>
    <div class="hh-search-overlay-backdrop"></div>
    <div class="hh-search-overlay-dialog">
      <div class="hh-search-overlay-header">
        <svg class="hh-search-overlay-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="search" class="hh-search-overlay-input" placeholder="Search documentation..." autocomplete="off">
        <kbd class="hh-search-overlay-shortcut">ESC</kbd>
      </div>
      <div class="hh-search-overlay-live" role="status" aria-live="polite" aria-atomic="true" style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;"></div>
      <div class="hh-search-overlay-results"><div class="hh-search-overlay-empty">Start typing to search...</div></div>
      <div class="hh-search-overlay-footer"><span>Navigate with <kbd>&uarr;</kbd><kbd>&darr;</kbd></span><span>Open with <kbd>&crarr;</kbd></span></div>
    </div>
  </div>

  <script src="./_assets/vendor/prism/prism.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-markup.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-css.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-javascript.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-java.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-python.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-json.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-bash.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-yaml.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-sql.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-markup-templating.min.js" defer></script>
  <script src="./_assets/vendor/prism/prism-velocity.min.js" defer></script>
  <script src="./_assets/vendor/lunr/lunr.min.js" defer></script>
  <script src="./_assets/js/theme.js" defer></script>
  <script src="./_assets/js/sidebar.js" defer></script>
  <script src="./_assets/js/toc.js" defer></script>
  <script src="./_assets/js/hh-heading-anchor.js" defer></script>
  <script src="./_assets/js/tabs.js" defer></script>
  <script src="./_assets/js/hh-accordion.js" defer></script>
  <script src="./_assets/js/hh-code-block.js" defer></script>
  <script src="./_assets/js/search.js" defer></script>

  <a href="#top" class="hh-back-to-top" aria-label="Back to top">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </a>
</body>
</html>